================================================================================
                    SIP BUDDY - COMPLETE PROJECT ANALYSIS
                         AI-Powered SIP Investment Planner
================================================================================

ðŸ“… CREATED: 2025-11-25
ðŸ“ PURPOSE: Complete project understanding and reference for future development
âš ï¸  NOTE: This is a reference document only - NO CODE CHANGES were made

================================================================================
                            1. PROJECT OVERVIEW
================================================================================

PROJECT NAME: SIP Buddy Next (AI SIP Planner)
PROJECT TYPE: Next.js 14+ Web Application (Migrated from React SPA)
PRIMARY PURPOSE: AI-powered personalized SIP (Systematic Investment Plan) and 
                 mutual fund investment planning platform for Indian investors

DOMAIN: FinTech / Investment Planning / Financial Education
TARGET AUDIENCE: Indian retail investors, beginners to advanced
DEPLOYMENT: Vercel (https://sipbuddy.vercel.app)

KEY VALUE PROPOSITION:
- AI-powered personalized investment recommendations using Google Gemini
- Real-time fund data with Google Search grounding
- Interactive AI chatbot for financial queries
- Comprehensive calculators (SIP, Lumpsum, SWP, Income Tax)
- Educational content hub about mutual funds and SIPs

================================================================================
                          2. TECHNOLOGY STACK
================================================================================

FRONTEND FRAMEWORK:
- Next.js (latest) - App Router architecture
- React 19.0.0
- TypeScript 5.8.2

STYLING:
- Tailwind CSS 3.4.18
- Custom CSS animations and gradients
- Responsive design (mobile-first)

BACKEND SERVICES:
- Firebase 12.5.0
  * Firebase Authentication (Email/Password, Google OAuth)
  * Cloud Firestore (NoSQL database)
  * Security Rules implemented

AI & DATA:
- Google Gemini API (@google/genai 1.27.0)
  * Investment plan generation
  * Chatbot (text + voice)
  * Text-to-Speech and Speech-to-Text
  * Google Search grounding for real fund data
  * Quiz generation

VISUALIZATION:
- Recharts 3.3.0 (Charts for growth projections, asset allocation)

PDF EXPORT:
- jsPDF 3.0.4
- html2canvas 1.4.1

DEVELOPMENT TOOLS:
- ESLint (Next.js config)
- Autoprefixer, PostCSS
- Node.js environment

================================================================================
                        3. PROJECT ARCHITECTURE
================================================================================

DIRECTORY STRUCTURE:
SIP-Buddy/
â”œâ”€â”€ app/                          # Next.js App Router pages
â”‚   â”œâ”€â”€ layout.tsx               # Root layout (metadata, providers)
â”‚   â”œâ”€â”€ page.tsx                 # Home page route
â”‚   â”œâ”€â”€ globals.css              # Global styles
â”‚   â”œâ”€â”€ about/page.tsx
â”‚   â”œâ”€â”€ auth/page.tsx
â”‚   â”œâ”€â”€ calculator/page.tsx
â”‚   â”œâ”€â”€ dashboard/page.tsx
â”‚   â”œâ”€â”€ learn/page.tsx
â”‚   â”œâ”€â”€ more/page.tsx
â”‚   â”œâ”€â”€ my-plans/page.tsx
â”‚   â”œâ”€â”€ planner/page.tsx
â”‚   â””â”€â”€ profile/page.tsx
â”‚
â”œâ”€â”€ components/                   # React components (all client-side)
â”‚   â”œâ”€â”€ AboutContent.tsx
â”‚   â”œâ”€â”€ AuthContent.tsx          # Login/Signup with Google OAuth
â”‚   â”œâ”€â”€ CalculatorContent.tsx    # Calculator selector
â”‚   â”œâ”€â”€ Chatbot.tsx              # AI chatbot with voice
â”‚   â”œâ”€â”€ ClientLayout.tsx         # Wrapper for client components
â”‚   â”œâ”€â”€ ComparisonModal.tsx      # Fund comparison modal
â”‚   â”œâ”€â”€ DashboardContent.tsx     # Investment plan dashboard
â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”œâ”€â”€ Header.tsx               # Navigation bar
â”‚   â”œâ”€â”€ HomeContent.tsx          # Landing page
â”‚   â”œâ”€â”€ Icons.tsx                # All icon components
â”‚   â”œâ”€â”€ LearnContent.tsx         # Educational hub
â”‚   â”œâ”€â”€ LoginRequiredModal.tsx
â”‚   â”œâ”€â”€ LumpsumCalculator.tsx
â”‚   â”œâ”€â”€ MoreContent.tsx          # Additional features menu
â”‚   â”œâ”€â”€ MyPlansContent.tsx       # Saved plans list
â”‚   â”œâ”€â”€ NotificationModal.tsx
â”‚   â”œâ”€â”€ OnboardingTour.tsx       # First-time user guide
â”‚   â”œâ”€â”€ PlanGeneratedLoginModal.tsx
â”‚   â”œâ”€â”€ PlannerContent.tsx       # Investment plan generator form
â”‚   â”œâ”€â”€ ProfileContent.tsx       # User profile management
â”‚   â”œâ”€â”€ SafeImage.tsx            # Image with fallback
â”‚   â”œâ”€â”€ SIPCalculator.tsx
â”‚   â”œâ”€â”€ SWPCalculator.tsx
â”‚   â””â”€â”€ tools/                   # Additional tool components
â”‚       â”œâ”€â”€ IncomeTaxCalculator.tsx
â”‚       â””â”€â”€ TaxInfoModal.tsx
â”‚
â”œâ”€â”€ context/
â”‚   â””â”€â”€ GlobalContext.tsx        # Global state management (Auth, Plans, Modals)
â”‚
â”œâ”€â”€ services/                     # Business logic layer
â”‚   â”œâ”€â”€ audioUtils.ts            # Audio encoding/decoding
â”‚   â”œâ”€â”€ firebase.ts              # Firebase initialization
â”‚   â”œâ”€â”€ firestoreService.ts      # Database operations
â”‚   â”œâ”€â”€ geminiService.ts         # AI service integration
â”‚   â””â”€â”€ pdfExportService.ts      # PDF generation
â”‚
â”œâ”€â”€ assets/
â”‚   â””â”€â”€ logo.ts                  # Logo assets
â”‚
â”œâ”€â”€ public/                       # Static assets
â”‚
â”œâ”€â”€ firebaseConfig.ts            # Firebase project configuration
â”œâ”€â”€ firestore.rules              # Firestore security rules
â”œâ”€â”€ types.ts                     # TypeScript type definitions
â”œâ”€â”€ next.config.mjs              # Next.js configuration
â”œâ”€â”€ tailwind.config.ts           # Tailwind CSS configuration
â”œâ”€â”€ tsconfig.json                # TypeScript configuration
â””â”€â”€ package.json                 # Dependencies and scripts

ARCHITECTURE PATTERN:
- Client-side rendering (CSR) - All pages marked with 'use client'
- Context API for global state management
- Service layer pattern for API calls
- Component composition pattern
- File-system based routing (Next.js App Router)

================================================================================
                      4. CORE FEATURES & FUNCTIONALITY
================================================================================

ðŸ  LANDING PAGE (HomeContent.tsx)
- Hero section with animated gradient background
- Feature highlights
- Call-to-action for plan creation
- Responsive design with modern UI

ðŸ“Š AI INVESTMENT PLANNER (PlannerContent.tsx)
HOW IT WORKS:
1. User fills financial profile form:
   - Monthly income
   - Age
   - Family members
   - Existing loans & tenure
   - Investment time horizon
   - Risk tolerance (Conservative/Moderate/Aggressive)
   - Investment goals
   - Optional: Annual step-up percentage

2. AI generates personalized plan via Gemini:
   - Calculates recommended monthly SIP amount
   - Creates asset allocation strategy
   - Provides growth projections (6 scenarios)
   - Recommends specific mutual funds with real data
   - Generates investment rationale

3. User can:
   - View detailed dashboard
   - Save plan to Firebase (requires auth)
   - Export as PDF
   - Create multiple plans

ðŸ“ˆ DASHBOARD (DashboardContent.tsx)
DISPLAYS:
- Summary cards (Monthly SIP, Risk Profile, Time Horizon, Asset Classes)
- Investment rationale explanation
- Asset allocation pie chart
- Growth projections (Chart + Table view toggle)
  * Amount Invested
  * Conservative, Expected, Aggressive scenarios
  * Recovery and Crash scenarios
- Fund recommendations by category
  * Fund details (3Y/5Y returns, expense ratio)
  * Fund comparison feature (select up to 5 funds)
  * Grounding sources (web links where data came from)

ACTIONS:
- Save plan (with custom name)
- Export to PDF
- Create new plan
- Compare funds

ðŸ’¼ MY PLANS (MyPlansContent.tsx)
- List all saved investment plans
- View plan details
- Delete plans
- Quick access to saved strategies

ðŸ§® CALCULATORS (CalculatorContent.tsx)
FOUR TYPES:

1. SIP Calculator (SIPCalculator.tsx)
   - Monthly investment
   - Expected return rate
   - Time period
   - Shows: Total invested, Expected returns, Maturity value
   - Growth chart visualization

2. Lumpsum Calculator (LumpsumCalculator.tsx)
   - One-time investment amount
   - Expected return rate
   - Time period
   - Similar output as SIP

3. SWP (Systematic Withdrawal Plan) Calculator (SWPCalculator.tsx)
   - Total investment
   - Monthly withdrawal
   - Expected return rate
   - Time period
   - Shows sustainability of withdrawals

4. Income Tax Calculator (IncomeTaxCalculator.tsx)
   FOR FY 2024-25 (AY 2025-26)
   
   FEATURES:
   - Toggle between Old and New Tax Regime
   - Real-time comparison of both regimes
   - Automatic recommendation based on tax savings
   
   INPUTS:
   Income:
   - Annual Income (from Salary)
   - Income from Other Sources
   
   Deductions (Old Regime Only):
   - Section 80C Deductions (Max: â‚¹1,50,000)
     * EPF, PPF, ELSS, Life Insurance Premiums
   - Section 80D (Medical Insurance Premium - Max: â‚¹1,00,000)
     * Health insurance for self, family, parents
   - HRA Exemption (Calculated based on rent paid)
   - Home Loan Interest - Section 24 (Max: â‚¹2,00,000)
   
   CALCULATIONS:
   - Standard Deduction: â‚¹50,000 (Both regimes)
   - Tax Rebate under Section 87A:
     * New Regime: Up to â‚¹7,00,000 taxable income = NIL tax
     * Old Regime: Up to â‚¹5,00,000 taxable income = NIL tax
   
   TAX SLABS:
   New Regime (Default):
   - Up to â‚¹3,00,000: Nil
   - â‚¹3,00,001 to â‚¹6,00,000: 5%
   - â‚¹6,00,001 to â‚¹9,00,000: 10%
   - â‚¹9,00,001 to â‚¹12,00,000: 15%
   - â‚¹12,00,001 to â‚¹15,00,000: 20%
   - Above â‚¹15,00,000: 30%
   
   Old Regime:
   - Up to â‚¹2,50,000: Nil
   - â‚¹2,50,001 to â‚¹5,00,000: 5%
   - â‚¹5,00,001 to â‚¹10,00,000: 20%
   - Above â‚¹10,00,000: 30%
   
   ADDITIONAL CHARGES:
   - Surcharge (for high-income earners):
     * â‚¹50L - â‚¹1Cr: 10% of income tax
     * â‚¹1Cr - â‚¹2Cr: 15% of income tax
     * Above â‚¹2Cr: 25% of income tax
   - Health & Education Cess: 4% on (Tax + Surcharge)
   
   OUTPUT DISPLAY:
   - Total Income
   - Taxable Income (after deductions)
   - Income Tax
   - Surcharge
   - Health & Education Cess (4%)
   - Total Tax Payable
   - Annual In-Hand Salary
   - Monthly In-Hand Salary
   - Regime Recommendation (which saves more tax)
   
   UI FEATURES:
   - Toggle switch for regime selection
   - Deductions automatically disabled for New Regime
   - Tooltips on input fields explaining each deduction
   - Info modal (TaxInfoModal.tsx) with:
     * Tax slab tables for both regimes
     * Section 87A rebate explanation
     * Standard deduction details
     * Deductions & exemptions guide
     * Surcharge & Cess explanation
     * Link to official Income Tax website
   - Formatted currency display (â‚¹ symbol, Indian number format)
   - Real-time calculation on input change
   - Responsive design for all screen sizes
   
   TECHNICAL FEATURES:
   - InputField component with formatted display
   - Max value validation for deductions
   - Automatic clamping to legal limits
   - useCallback for optimized calculations
   - Regime comparison logic
   - Disabled state styling for unavailable deductions

ðŸ“š LEARN HUB (LearnContent.tsx)
EDUCATIONAL CONTENT CATEGORIES:
1. Foundations
   - What is SIP?
   - Lumpsum vs SIP
   - Time Value of Money
   - Mutual Funds 101
   - Mutual Funds vs Stocks
   - Emergency Fund First

2. Analysis
   - SEBI Mutual Fund Categories
   - Direct vs Regular Plans
   - Choosing the Right Mutual Fund
   - Expense Ratio
   - Key Ratios & Metrics (Alpha, Beta, Standard Deviation)
   - Sharpe Ratio

3. Strategy
   - Asset Allocation
   - Portfolio Overlap
   - Index Funds vs Active Funds
   - Portfolio Rebalancing
   - Investment Strategies

4. Risk & Tax
   - Understanding Risk
   - Tax Implications
   - Exit Load
   - Red Flags to Watch
   - Important Disclaimer

FEATURES:
- Search functionality
- Category filtering
- Article view with markdown rendering
- Read time indicators
- Beautiful UI with icons

ðŸ’¬ AI CHATBOT (Chatbot.tsx)
CAPABILITIES:
- Text-based Q&A about investments
- Voice input (Speech-to-Text)
- Voice output (Text-to-Speech)
- Context-aware responses
- Markdown formatting in responses
- Can be triggered from other components via custom event
- Floating button (bottom-right)

TECHNICAL FEATURES:
- Real-time streaming responses
- Audio playback controls
- Recording indicator
- Transcription status
- Message history

ðŸ” AUTHENTICATION (AuthContent.tsx)
METHODS:
1. Email/Password (Login & Signup)
2. Google OAuth

FEATURES:
- Toggle between login/signup
- Form validation
- Password reset
- Profile creation on signup
- Redirect logic based on auth state

ðŸ‘¤ PROFILE (ProfileContent.tsx)
- Display name editing
- Email (readonly)
- Profile picture URL management
- Account deletion with confirmation
- Updates Firebase Auth + Firestore

ðŸ”’ PROTECTED ROUTES:
- /dashboard - requires plan or saved plans
- /my-plans - requires authentication
- /profile - requires authentication

================================================================================
                        5. DESIGN THEME & AESTHETICS
================================================================================

COLOR PALETTE:
Primary: Blue (#3b82f6, #2563eb shades)
Secondary: Indigo, Purple accents
Success: Green (#10b981)
Warning: Yellow/Orange
Error: Red (#ef4444)
Neutral: Slate grays (#f8fafc, #64748b, #1e293b)

DESIGN PRINCIPLES:
âœ¨ Modern, Premium UI
- Glassmorphism effects
- Gradient backgrounds (animated)
- Soft shadows and borders
- Rounded corners (border-radius)
- Smooth transitions and hover effects
- Micro-animations

ðŸ“± Responsive Design
- Mobile-first approach
- Breakpoints: sm, md, lg
- Touch-friendly buttons
- Collapsible navigation on mobile

ðŸŽ¨ Visual Elements
- Custom SVG icons (IconX, IconSparkles, etc.)
- Animated loading states
- Progress bars with gradients
- Pulse animations
- Fade-in effects
- Skeleton loaders

ðŸ“Š Data Visualization
- Recharts for interactive charts
- Pie charts (asset allocation)
- Line charts (growth projections)
- Responsive charts
- Custom tooltips and legends
- Color-coded data points

TYPOGRAPHY:
- Font: System fonts (font-sans)
- Headings: Bold, large sizes
- Body text: Readable, good line-height
- Monospace for numbers (optional)

================================================================================
                    6. STATE MANAGEMENT ARCHITECTURE
================================================================================

GLOBAL CONTEXT (GlobalContext.tsx):
Manages:
- user: User | null (Firebase Auth user)
- authLoading: boolean
- currentPlan: CurrentPlanState | null
  * planData: InvestmentPlan
  * userProfile: UserProfile
  * isSaved: boolean
  * id?: string
- isLoginModalOpen: boolean
- isPlanLoginModalOpen: boolean

Methods:
- handlePlanGenerated() - Stores newly generated plan, redirects to dashboard
- handleSavePlan() - Saves plan to Firestore
- handleCreateNewPlan() - Clears current plan, navigates to planner
- handleViewPlan() - Loads saved plan to dashboard
- handleLogout() - Signs out, clears plan
- handleProfileUpdate() - Updates user state
- handleLoginFromModal() - Modal navigation to auth
- handlePlanLoginConfirm() - Auth redirect with plan
- handlePlanLoginCancel() - Cancels plan save

AUTH FLOW:
1. App loads â†’ onAuthStateChanged listener
2. If user logged in â†’ Check for authRedirectPlan
   - If plan exists â†’ Load to dashboard
   - Else if on /auth â†’ Redirect to /planner
3. If user logged out â†’ Check protected routes
   - If on protected route â†’ Redirect to /
   - Clear currentPlan

PLAN FLOW:
1. User fills planner form â†’ Generates plan
2. If logged in â†’ Save to currentPlan â†’ Navigate to /dashboard
3. If not logged in â†’ Show login modal â†’ Save plan temporarily
4. After login â†’ Auto-load plan to dashboard
5. User can save plan to Firestore with custom name
6. Saved plans accessible from /my-plans

================================================================================
                          7. DATA MODELS (types.ts)
================================================================================

ENUMS:
- Page (Home, Planner, Dashboard, Learn, etc.)
- RiskTolerance (Conservative, Moderate, Aggressive)

CORE INTERFACES:

UserProfile {
  monthlyIncome: number
  age: number
  familyMembers: number
  existingLoans: number
  loanTenureRemaining: number
  investmentTimeHorizon: number
  riskTolerance: RiskTolerance
  investmentGoal: string
  stepUpPercentage?: number
}

Fund {
  name: string
  fundHouse: string
  threeYearReturns: string
  fiveYearReturns: string
  expenseRatio: string
  description: string
}

FundCategory {
  category: string
  allocationPercentage: number
  funds: Fund[]
}

AssetAllocationItem {
  name: string (e.g., "Equity", "Debt", "Gold")
  value: number (percentage)
}

GrowthDataPoint {
  year: number
  amountInvested: number
  conservative: number
  expected: number
  aggressive: number
  recovery: number
  crash: number
}

InvestmentPlan {
  monthlySip: number
  riskProfile: string
  timeHorizon: number
  assetClasses: number
  investmentRationale: string
  assetAllocation: AssetAllocationItem[]
  growthProjections: GrowthDataPoint[]
  fundRecommendations: FundCategory[]
  groundingChunks?: GroundingChunk[]
}

SavedPlan {
  id: string
  userId: string
  planName: string
  createdAt: { seconds, nanoseconds }
  investmentPlan: InvestmentPlan
  userProfile: UserProfile
}

ChatMessage {
  role: 'user' | 'model'
  text: string
  audioData?: string
  isPlaying?: boolean
}

QuizQuestion, QuizResult, FinancialAdvisor (for future features)

================================================================================
                      8. AI SERVICES (geminiService.ts)
================================================================================

GEMINI API INTEGRATION:

1. INVESTMENT PLAN GENERATION (generateInvestmentPlan)
   INPUT: UserProfile
   PROCESS:
   - Uses Gemini Pro with Google Search tool
   - System instructions: Indian financial advisor persona
   - Generates structured JSON response
   - Includes grounding chunks (web sources)
   
   OUTPUT: InvestmentPlan with:
   - Monthly SIP recommendation
   - Asset allocation breakdown
   - Growth projections (6 scenarios)
   - Fund recommendations with real data
   - Investment rationale
   
   FEATURES:
   - Sanitization of output (prevents NaN, undefined)
   - Error handling
   - Real fund data via Google Search grounding

2. CHATBOT (startChat, sendMessageToChat)
   - Maintains conversation history
   - Context-aware responses
   - System instructions: SIP/mutual fund expert
   
3. TEXT-TO-SPEECH (textToSpeech)
   - Converts AI text responses to audio
   - Returns base64 encoded audio
   - Sample rate: 24kHz, PCM format
   
4. SPEECH-TO-TEXT (transcribeAudio)
   - Converts audio blob to text
   - Uses Gemini with audio input
   
5. QUIZ GENERATION (generateQuizQuestions)
   - Generates financial literacy quizzes
   - Difficulty levels: Easy, Medium, Hard
   - Question types: MCQ, True/False, Fill-in-blank
   
6. FINANCIAL ADVISOR FINDER (findFinancialAdvisors)
   - Uses Google Maps search
   - Location-based or query-based search
   - Returns advisor details with contact info

================================================================================
                    9. FIREBASE SERVICES (firestoreService.ts)
================================================================================

FIRESTORE COLLECTIONS:

1. 'plans' Collection
   Document structure:
   {
     userId: string
     planName: string
     investmentPlan: InvestmentPlan (sanitized)
     userProfile: UserProfile (sanitized)
     createdAt: serverTimestamp
   }
   
   Operations:
   - savePlan(userId, planName, investmentPlan, userProfile) â†’ planId
   - getUserPlans() â†’ SavedPlan[] (sorted by createdAt DESC)
   - deletePlan(planId) â†’ void

2. 'users' Collection
   Document structure:
   {
     uid: string
     email: string
     displayName: string
     photoURL: string
     createdAt: serverTimestamp
   }
   
   Operations:
   - createUserProfileDocument(user) â†’ void (on signup)
   - updateUserProfileDocument(uid, data) â†’ void
   - deleteUserDocument(uid) â†’ void (on account deletion)

SECURITY:
- sanitizeForFirestore() removes undefined values
- Auth state checked before operations
- Empty array returned for non-authenticated users

FIRESTORE RULES (firestore.rules):
- Read/Write plans: Only if authenticated and owner
- Read/Write/Delete users: Only if authenticated and own document
- Service rules for testing

================================================================================
                        10. PDF EXPORT (pdfExportService.ts)
================================================================================

FUNCTIONALITY:
- Exports dashboard to PDF
- Uses html2canvas to capture dashboard
- Uses jsPDF to generate PDF

PROCESS:
1. Temporarily sets isExporting state
2. Removes interactive elements (buttons)
3. Shows both chart and table views
4. Captures dashboard content as canvas
5. Converts to PDF with proper formatting
6. Downloads as "Investment_Plan_[timestamp].pdf"

FEATURES:
- Progress callbacks
- Error handling
- Responsive sizing
- Preserves colors and formatting

================================================================================
                    11. ROUTING & NAVIGATION
================================================================================

ROUTES:
/ â†’ Home (landing page)
/planner â†’ Investment plan creation form
/dashboard â†’ Investment plan dashboard (requires plan)
/my-plans â†’ Saved plans list (requires auth)
/calculator â†’ Calculator selector
/learn â†’ Educational hub
/more â†’ Additional features
/auth â†’ Login/Signup
/profile â†’ User profile (requires auth)
/about â†’ About page

NAVIGATION COMPONENTS:
- Header.tsx - Main navigation bar
  * Logo
  * Desktop menu (hidden on mobile)
  * Mobile hamburger menu
  * User profile dropdown (when logged in)
  * Login button (when logged out)
  
- Footer.tsx - Footer with links
  * Quick links
  * Social links
  * Disclaimer
  * Copyright

PROTECTED ROUTE LOGIC:
- Handled in GlobalContext useEffect
- Checks pathname and auth state
- Redirects unauthenticated users to /
- Redirects authenticated users from /auth to /planner

================================================================================
                    12. IMPORTANT FUNCTIONALITIES TO PRESERVE
================================================================================

âš ï¸ CRITICAL: When adding new features, DO NOT BREAK:

1. AUTHENTICATION FLOW
   - Email/password login and signup
   - Google OAuth integration
   - Auth state persistence
   - Protected route redirects
   - Profile creation on signup

2. PLAN GENERATION & SAVING
   - AI plan generation via Gemini
   - Plan state management in context
   - Save to Firestore functionality
   - Plan retrieval and display
   - Multiple plan support

3. DASHBOARD FUNCTIONALITY
   - All visualizations (charts, tables)
   - Asset allocation display
   - Growth projections
   - Fund recommendations
   - PDF export
   - Fund comparison modal

4. CHATBOT
   - Text and voice input
   - Audio playback
   - Conversation history
   - Event-based opening from other components

5. CALCULATORS
   - All four calculator types (SIP, Lumpsum, SWP, Income Tax)
   - Calculations accuracy
   - Chart visualizations
   - Tax regime comparisons (Income Tax Calculator)

6. RESPONSIVE DESIGN
   - Mobile navigation
   - Tablet layouts
   - Desktop experience
   - Touch interactions

7. DATA INTEGRITY
   - Firestore sanitization
   - Type safety with TypeScript
   - Error boundaries
   - Loading states

================================================================================
                    13. DEVELOPMENT GUIDELINES
================================================================================

WHEN ADDING NEW FEATURES:

âœ… DO:
1. Maintain TypeScript strict typing
2. Use 'use client' directive for client components
3. Follow existing component structure
4. Add types to types.ts
5. Use GlobalContext for shared state
6. Implement error handling
7. Add loading states
8. Make it responsive (mobile-first)
9. Follow existing design system (colors, spacing)
10. Test auth-protected features with login/logout
11. Sanitize data before Firestore writes
12. Add proper aria-labels for accessibility

âŒ DON'T:
1. Modify existing auth flow without understanding impact
2. Change GlobalContext structure without checking all consumers
3. Break existing API contracts (types, function signatures)
4. Remove sanitization functions
5. Ignore mobile responsiveness
6. Skip error handling
7. Hard-code values (use types/constants)
8. Mix server and client components incorrectly
9. Modify firestore.rules without understanding security implications
10. Change PDF export without testing

ADDING NEW PAGES:
1. Create page.tsx in app/[route]/ directory
2. Create [Route]Content.tsx in components/
3. Mark with 'use client' if using hooks
4. Add route to navigation (Header.tsx)
5. Update types.ts if needed
6. Add to protected routes list if auth required
7. Test navigation from all entry points

ADDING NEW FEATURES TO EXISTING PAGES:
1. Review existing component structure
2. Check if GlobalContext update needed
3. Maintain existing functionality
4. Add new types to types.ts
5. Update relevant service files
6. Test with different user states (logged in/out)
7. Ensure mobile responsiveness

STYLING:
- Use Tailwind utility classes
- Follow existing pattern (e.g., "bg-blue-600 hover:bg-blue-700")
- Use consistent spacing (p-4, gap-6, etc.)
- Add custom CSS to globals.css for animations
- Use existing color palette
- Maintain shadow and border-radius consistency

================================================================================
                    14. ENVIRONMENT VARIABLES & CONFIG
================================================================================

REQUIRED ENVIRONMENT VARIABLES (.env.local):
GEMINI_API_KEY=your_gemini_api_key_here

FIREBASE CONFIG (firebaseConfig.ts):
- apiKey, authDomain, projectId (already configured)
- Don't commit sensitive keys to version control
- Firebase project: "sip-buddy-next"

NEXT.JS CONFIG (next.config.mjs):
- Minimal configuration
- No special image domains configured
- Default Next.js settings

TAILWIND CONFIG (tailwind.config.ts):
- Content paths: app/**, components/**
- Extended theme (if any customizations)

================================================================================
                        15. COMMON PATTERNS & CONVENTIONS
================================================================================

COMPONENT STRUCTURE:
```
'use client'; // if using hooks

import React, { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useGlobalContext } from '../context/GlobalContext';

const ComponentName: React.FC = () => {
  const { user, currentPlan } = useGlobalContext();
  const router = useRouter();
  
  // State
  // Effects
  // Handlers
  
  return (
    <div className="max-w-6xl mx-auto p-4">
      {/* Content */}
    </div>
  );
};

export default ComponentName;
```

ERROR HANDLING PATTERN:
```
try {
  const result = await someAsyncOperation();
  // Success handling
} catch (error) {
  console.error("Error message:", error);
  // User-facing error handling
  throw error; // or handle gracefully
} finally {
  setIsLoading(false);
}
```

LOADING STATES:
- Use boolean flags: isLoading, isSaving, isGenerating
- Show spinners or skeleton UI
- Disable buttons during operations
- Clear messaging to user

MODAL PATTERN:
- Controlled by state: isModalOpen
- Close handlers
- Overlay with backdrop
- Keyboard accessibility (Escape key)

FORM HANDLING:
- Controlled inputs with useState
- Form validation before submit
- Disabled submit during processing
- Error display below fields
- Success feedback

================================================================================
                            DOCUMENT END
================================================================================

For questions or clarifications about this project, review:
1. This analysis document
2. MIGRATION_LOG.md in project root
3. Code comments in individual files
4. Official documentation for libraries used

IMPORTANT: Always test in development before deploying to production!

================================================================================
                            REVISION HISTORY
================================================================================

2025-11-25 12:19 IST - Initial document created
2025-11-25 12:32 IST - Updated to include Income Tax Calculator
                       - Added comprehensive documentation for tax calculator
                       - Updated deployment URL to https://sipbuddy.vercel.app
                       - Documented both Old and New tax regime support
                       - Included all tax slab details and calculations

LAST UPDATED: 2025-11-25 12:32 IST

