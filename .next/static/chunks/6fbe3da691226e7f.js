(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53374,e=>{"use strict";let t,n;var i,l,r,o,a,s,u,p,d,c,h,m,f,g,y,E,_,v,I,T,A,S,C,O,b,N,R,P,M,w,D,U,q,k,x,L,G,F,H,V,j,B,J,Y,K,W,$,z,X,Q,Z,ee,et,en,ei,el,er,eo,ea,es,eu,ep,ed,ec,eh,em,ef,eg,ey,eE,e_,ev,eI,eT,eA,eS,eC,eO,eb,eN,eR,eP,eM,ew,eD,eU,eq,ek,ex,eL,eG,eF,eH,eV,ej,eB,eJ,eY,eK,eW,e$,ez,eX,eQ,eZ,e0,e1,e2,e3,e4,e5,e6,e8=e.i(26903);class e7{}function e9(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){let e=t[n];return null!=e?String(e):""}throw Error(`Key '${n}' not found in valueMap.`)})}function te(e,t,n){for(let i=0;i<t.length-1;i++){let l=t[i];if(l.endsWith("[]")){let r=l.slice(0,-2);if(!(r in e))if(Array.isArray(n))e[r]=Array.from({length:n.length},()=>({}));else throw Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[r])){let l=e[r];if(Array.isArray(n))for(let e=0;e<l.length;e++)te(l[e],t.slice(i+1),n[e]);else for(let e of l)te(e,t.slice(i+1),n)}return}if(l.endsWith("[0]")){let r=l.slice(0,-3);r in e||(e[r]=[{}]),te(e[r][0],t.slice(i+1),n);return}e[l]&&"object"==typeof e[l]||(e[l]={}),e=e[l]}let i=t[t.length-1],l=e[i];if(void 0!==l){if(!n||"object"==typeof n&&0===Object.keys(n).length||n===l)return;if("object"==typeof l&&"object"==typeof n&&null!==l&&null!==n)Object.assign(l,n);else throw Error(`Cannot set value for an existing key. Key: ${i}`)}else"_self"!==i||"object"!=typeof n||null===n||Array.isArray(n)?e[i]=n:Object.assign(e,n)}function tt(e,t,n){try{if(1===t.length&&"_self"===t[0])return e;for(let i=0;i<t.length;i++){if("object"!=typeof e||null===e)return n;let l=t[i];if(l.endsWith("[]")){let r=l.slice(0,-2);if(!(r in e))return n;{let l=e[r];if(!Array.isArray(l))return n;return l.map(e=>tt(e,t.slice(i+1),n))}}e=e[l]}return e}catch(e){if(e instanceof TypeError)return n;throw e}}function tn(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e}function ti(e){var t;let n,i,l,r,o={},a=tt(e,["name"]);null!=a&&te(o,["name"],a);let s=tt(e,["metadata"]);null!=s&&te(o,["metadata"],s);let u=tt(e,["done"]);null!=u&&te(o,["done"],u);let p=tt(e,["error"]);null!=p&&te(o,["error"],p);let d=tt(e,["response"]);return null!=d&&te(o,["response"],(n={},null!=(i=tt(t=d,["sdkHttpResponse"]))&&te(n,["sdkHttpResponse"],i),null!=(l=tt(t,["parent"]))&&te(n,["parent"],l),null!=(r=tt(t,["documentName"]))&&te(n,["documentName"],r),n)),o}(i=er||(er={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(l=eo||(eo={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",l.PYTHON="PYTHON",(r=ea||(ea={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",r.SILENT="SILENT",r.WHEN_IDLE="WHEN_IDLE",r.INTERRUPT="INTERRUPT",(o=es||(es={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT",o.NULL="NULL",(a=eu||(eu={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC",(s=ep||(ep={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",s.SIMPLE_SEARCH="SIMPLE_SEARCH",s.ELASTIC_SEARCH="ELASTIC_SEARCH",(u=ed||(ed={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",u.NO_AUTH="NO_AUTH",u.API_KEY_AUTH="API_KEY_AUTH",u.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",u.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",u.OAUTH="OAUTH",u.OIDC_AUTH="OIDC_AUTH",(p=ec||(ec={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",p.HTTP_IN_QUERY="HTTP_IN_QUERY",p.HTTP_IN_HEADER="HTTP_IN_HEADER",p.HTTP_IN_PATH="HTTP_IN_PATH",p.HTTP_IN_BODY="HTTP_IN_BODY",p.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(d=eh||(eh={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",d.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",d.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",d.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",d.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",d.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",d.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(c=em||(em={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",c.LOW="LOW",c.HIGH="HIGH",(h=ef||(ef={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",h.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",h.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",h.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",h.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",h.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",h.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",h.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",h.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",h.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",h.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(m=eg||(eg={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",m.SEVERITY="SEVERITY",m.PROBABILITY="PROBABILITY",(f=ey||(ey={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",f.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",f.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",f.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",f.BLOCK_NONE="BLOCK_NONE",f.OFF="OFF",(g=eE||(eE={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",g.STOP="STOP",g.MAX_TOKENS="MAX_TOKENS",g.SAFETY="SAFETY",g.RECITATION="RECITATION",g.LANGUAGE="LANGUAGE",g.OTHER="OTHER",g.BLOCKLIST="BLOCKLIST",g.PROHIBITED_CONTENT="PROHIBITED_CONTENT",g.SPII="SPII",g.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",g.IMAGE_SAFETY="IMAGE_SAFETY",g.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",g.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",g.NO_IMAGE="NO_IMAGE",(y=e_||(e_={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",y.NEGLIGIBLE="NEGLIGIBLE",y.LOW="LOW",y.MEDIUM="MEDIUM",y.HIGH="HIGH",(E=ev||(ev={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",E.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",E.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",E.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",E.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(_=eI||(eI={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",_.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",_.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",_.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",_.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(v=eT||(eT={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",v.SAFETY="SAFETY",v.OTHER="OTHER",v.BLOCKLIST="BLOCKLIST",v.PROHIBITED_CONTENT="PROHIBITED_CONTENT",v.IMAGE_SAFETY="IMAGE_SAFETY",v.MODEL_ARMOR="MODEL_ARMOR",v.JAILBREAK="JAILBREAK",(I=eA||(eA={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",I.ON_DEMAND="ON_DEMAND",I.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(T=eS||(eS={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",T.TEXT="TEXT",T.IMAGE="IMAGE",T.AUDIO="AUDIO",(A=eC||(eC={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",A.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",A.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",A.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(S=eO||(eO={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",S.TUNING_MODE_FULL="TUNING_MODE_FULL",S.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(C=eb||(eb={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",C.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",C.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",C.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",C.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",C.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",C.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(O=eN||(eN={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",O.JOB_STATE_QUEUED="JOB_STATE_QUEUED",O.JOB_STATE_PENDING="JOB_STATE_PENDING",O.JOB_STATE_RUNNING="JOB_STATE_RUNNING",O.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",O.JOB_STATE_FAILED="JOB_STATE_FAILED",O.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",O.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",O.JOB_STATE_PAUSED="JOB_STATE_PAUSED",O.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",O.JOB_STATE_UPDATING="JOB_STATE_UPDATING",O.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(b=eR||(eR={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",b.TUNING_TASK_I2V="TUNING_TASK_I2V",b.TUNING_TASK_T2V="TUNING_TASK_T2V",b.TUNING_TASK_R2V="TUNING_TASK_R2V",(N=eP||(eP={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",N.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",N.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",N.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(R=eM||(eM={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",R.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",R.BALANCED="BALANCED",R.PRIORITIZE_COST="PRIORITIZE_COST",(P=ew||(ew={})).UNSPECIFIED="UNSPECIFIED",P.BLOCKING="BLOCKING",P.NON_BLOCKING="NON_BLOCKING",(M=eD||(eD={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",M.MODE_DYNAMIC="MODE_DYNAMIC",(w=eU||(eU={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",w.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(D=eq||(eq={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",D.AUTO="AUTO",D.ANY="ANY",D.NONE="NONE",D.VALIDATED="VALIDATED",(U=ek||(ek={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",U.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",U.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",U.BLOCK_NONE="BLOCK_NONE",(q=ex||(ex={})).DONT_ALLOW="DONT_ALLOW",q.ALLOW_ADULT="ALLOW_ADULT",q.ALLOW_ALL="ALLOW_ALL",(k=eL||(eL={})).auto="auto",k.en="en",k.ja="ja",k.ko="ko",k.hi="hi",k.zh="zh",k.pt="pt",k.es="es",(x=eG||(eG={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",x.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",x.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",x.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",x.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(L=eF||(eF={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",L.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",L.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",L.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(G=eH||(eH={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",G.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",G.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",G.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(F=eV||(eV={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",F.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",F.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",F.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",F.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",F.EDIT_MODE_STYLE="EDIT_MODE_STYLE",F.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",F.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(H=ej||(ej={})).FOREGROUND="FOREGROUND",H.BACKGROUND="BACKGROUND",H.PROMPT="PROMPT",H.SEMANTIC="SEMANTIC",H.INTERACTIVE="INTERACTIVE",(V=eB||(eB={})).ASSET="ASSET",V.STYLE="STYLE",(j=eJ||(eJ={})).INSERT="INSERT",j.REMOVE="REMOVE",j.REMOVE_STATIC="REMOVE_STATIC",j.OUTPAINT="OUTPAINT",(B=eY||(eY={})).OPTIMIZED="OPTIMIZED",B.LOSSLESS="LOSSLESS",(J=eK||(eK={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",J.PREFERENCE_TUNING="PREFERENCE_TUNING",(Y=eW||(eW={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Y.STATE_PENDING="STATE_PENDING",Y.STATE_ACTIVE="STATE_ACTIVE",Y.STATE_FAILED="STATE_FAILED",(K=e$||(e$={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",K.PROCESSING="PROCESSING",K.ACTIVE="ACTIVE",K.FAILED="FAILED",(W=ez||(ez={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",W.UPLOADED="UPLOADED",W.GENERATED="GENERATED",($=eX||(eX={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",$.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",$.RESPONSE_REJECTED="RESPONSE_REJECTED",$.NEED_MORE_INPUT="NEED_MORE_INPUT",(z=eQ||(eQ={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",z.TEXT="TEXT",z.IMAGE="IMAGE",z.VIDEO="VIDEO",z.AUDIO="AUDIO",z.DOCUMENT="DOCUMENT",(X=eZ||(eZ={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",X.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",X.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(Q=e0||(e0={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",Q.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",Q.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(Z=e1||(e1={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",Z.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",Z.NO_INTERRUPTION="NO_INTERRUPTION",(ee=e2||(e2={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",ee.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",ee.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(et=e3||(e3={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",et.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",et.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",et.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",et.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",et.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",et.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",et.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",et.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",et.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",et.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",et.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",et.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(en=e4||(e4={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",en.QUALITY="QUALITY",en.DIVERSITY="DIVERSITY",en.VOCALIZATION="VOCALIZATION",(ei=e5||(e5={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",ei.PLAY="PLAY",ei.PAUSE="PAUSE",ei.STOP="STOP",ei.RESET_CONTEXT="RESET_CONTEXT";class tl{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class tr{get text(){var e,t,n,i,l,r,o,a;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let s="",u=!1,p=[];for(let e of null!=(a=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?a:[]){for(let[t,n]of Object.entries(e))"text"!==t&&"thought"!==t&&"thoughtSignature"!==t&&(null!==n||void 0!==n)&&p.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,s+=e.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?s:void 0}get data(){var e,t,n,i,l,r,o,a;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let s="",u=[];for(let e of null!=(a=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?a:[]){for(let[t,n]of Object.entries(e))"inlineData"!==t&&(null!==n||void 0!==n)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(s+=atob(e.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}get functionCalls(){var e,t,n,i,l,r,o,a;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let s=null==(a=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==s?void 0:s.length)!==0)return s}get executableCode(){var e,t,n,i,l,r,o,a,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null==(a=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(s=null==u?void 0:u[0])?void 0:s.code}get codeExecutionResult(){var e,t,n,i,l,r,o,a,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null==(a=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(s=null==u?void 0:u[0])?void 0:s.output}}class to{}class ta{}class ts{}class tu{}class tp{}class td{}class tc{}class th{}class tm{}class tf{}class tg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n,i=new tg;if(t){let t,i,l,r,o,a;t={},null!=(i=tt(e,["name"]))&&te(t,["name"],i),null!=(l=tt(e,["metadata"]))&&te(t,["metadata"],l),null!=(r=tt(e,["done"]))&&te(t,["done"],r),null!=(o=tt(e,["error"]))&&te(t,["error"],o),null!=(a=tt(e,["response"]))&&te(t,["response"],function(e){let t={},n=tt(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a;return n={},null!=(i=tt(e,["_self"]))&&te(n,["video"],(l={},null!=(r=tt(t=i,["gcsUri"]))&&te(l,["uri"],r),null!=(o=tt(t,["bytesBase64Encoded"]))&&te(l,["videoBytes"],tn(o)),null!=(a=tt(t,["mimeType"]))&&te(l,["mimeType"],a),l)),n})),te(t,["generatedVideos"],e)}let i=tt(e,["raiMediaFilteredCount"]);null!=i&&te(t,["raiMediaFilteredCount"],i);let l=tt(e,["raiMediaFilteredReasons"]);return null!=l&&te(t,["raiMediaFilteredReasons"],l),t}(a)),n=t}else{let t,i,l,r,o,a;t={},null!=(i=tt(e,["name"]))&&te(t,["name"],i),null!=(l=tt(e,["metadata"]))&&te(t,["metadata"],l),null!=(r=tt(e,["done"]))&&te(t,["done"],r),null!=(o=tt(e,["error"]))&&te(t,["error"],o),null!=(a=tt(e,["response","generateVideoResponse"]))&&te(t,["response"],function(e){let t={},n=tt(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a;return n={},null!=(i=tt(e,["video"]))&&te(n,["video"],(l={},null!=(r=tt(t=i,["uri"]))&&te(l,["uri"],r),null!=(o=tt(t,["encodedVideo"]))&&te(l,["videoBytes"],tn(o)),null!=(a=tt(t,["encoding"]))&&te(l,["mimeType"],a),l)),n})),te(t,["generatedVideos"],e)}let i=tt(e,["raiMediaFilteredCount"]);null!=i&&te(t,["raiMediaFilteredCount"],i);let l=tt(e,["raiMediaFilteredReasons"]);return null!=l&&te(t,["raiMediaFilteredReasons"],l),t}(a)),n=t}return Object.assign(i,n),i}}class ty{}class tE{}class t_{}class tv{}class tI{}class tT{}class tA{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){var n;let i,l,r,o,a,s,u,p,d,c,h=new tA;return Object.assign(h,(a={},null!=(s=tt(e,["name"]))&&te(a,["name"],s),null!=(u=tt(e,["metadata"]))&&te(a,["metadata"],u),null!=(p=tt(e,["done"]))&&te(a,["done"],p),null!=(d=tt(e,["error"]))&&te(a,["error"],d),null!=(c=tt(e,["response"]))&&te(a,["response"],(i={},null!=(l=tt(n=c,["sdkHttpResponse"]))&&te(i,["sdkHttpResponse"],l),null!=(r=tt(n,["parent"]))&&te(i,["parent"],r),null!=(o=tt(n,["documentName"]))&&te(i,["documentName"],o),i)),a)),h}}class tS{}class tC{}class tO{}class tb{}class tN{get text(){var e,t,n;let i="",l=!1,r=[];for(let o of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&r.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;l=!0,i+=o.text}}return r.length>0&&console.warn(`there are non-text parts ${r} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?i:void 0}get data(){var e,t,n;let i="",l=[];for(let r of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(r))"inlineData"!==e&&null!==t&&l.push(e);r.inlineData&&"string"==typeof r.inlineData.data&&(i+=atob(r.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class tR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class tP{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n=new tP;return Object.assign(n,ti(e)),n}}function tM(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw Error("invalid model parameter");if(e.isVertexAI())if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;else{if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function tw(e,t){let n=tM(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function tD(e){return Array.isArray(e)?e.map(e=>tU(e)):[tU(e)]}function tU(e){if("object"==typeof e&&null!==e)return e;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function tq(e){let t=tU(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function tk(e){let t=tU(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function tx(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error(`Unsupported part type: ${typeof e}`)}function tL(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>tx(e)):[tx(e)]}function tG(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function tF(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function tH(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function tV(e){if(null==e)throw Error("ContentUnion is required");return tG(e)?e:{role:"user",parts:tL(e)}}function tj(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=tV(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){let e=tV(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>tV(e)):[tV(t)]}function tB(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(tF(e)||tH(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[tV(e)]}let t=[],n=[],i=tG(e[0]);for(let l of e){let e=tG(l);if(e!=i)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(l);else if(tF(l)||tH(l))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else n.push(l)}return i||t.push({role:"user",parts:tL(n)}),t}function tJ(e){let t={},n=["items"],i=["anyOf"],l=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let r=e.anyOf;for(let[o,a]of(null!=r&&2==r.length&&("null"===r[0].type?(t.nullable=!0,e=r[1]):"null"===r[1].type&&(t.nullable=!0,e=r[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(es).includes(n[0].toUpperCase())?n[0].toUpperCase():es.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],n))t.anyOf.push({type:Object.values(es).includes(e.toUpperCase())?e.toUpperCase():es.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=a)if("type"==o){if("null"===a)throw Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(es).includes(a.toUpperCase())?a.toUpperCase():es.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=tJ(a);else if(i.includes(o)){let e=[];for(let n of a){if("null"==n.type){t.nullable=!0;continue}e.push(tJ(n))}t[o]=e}else if(l.includes(o)){let e={};for(let[t,n]of Object.entries(a))e[t]=tJ(n);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=a}return t}function tY(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error(`Unsupported speechConfig type: ${typeof e}`)}function tK(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function tW(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=tJ(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=tJ(t.response));return e}function t$(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let n of e)t.push(n);return t}function tz(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,n,i=1){let l=!t.startsWith(`${n}/`)&&t.split("/").length===i;if(e.isVertexAI())if(t.startsWith("projects/"))return t;else if(t.startsWith("locations/"))return`projects/${e.getProject()}/${t}`;else if(t.startsWith(`${n}/`))return`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`;else if(l)return`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`;else return t;return l?`${n}/${t}`:t}(e,t,"cachedContents")}function tX(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function tQ(e){var t;let n;if(null!=e&&"object"==typeof e&&"name"in e&&(n=e.name),null==e||"object"!=typeof e||!("uri"in e)||void 0!==(n=e.uri)){if(null==e||"object"!=typeof e||!("video"in e)||void 0!==(n=null==(t=e.video)?void 0:t.uri)){if("string"==typeof e&&(n=e),void 0===n)throw Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){let e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}}function tZ(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function t0(e){for(let i of["models","tunedModels","publisherModels"]){var t,n;if(t=e,n=i,null!==t&&"object"==typeof t&&n in t)return e[i]}return[]}function t1(e,t){let n;if("string"==typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;let i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,l=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(l>0||1!==i)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||1!==l)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function t2(e){if("object"!=typeof e||null===e)return{};let t=e.inlinedResponses;if("object"!=typeof t||null===t)return e;let n=t.inlinedResponses;if(!Array.isArray(n)||0===n.length)return e;let i=!1;for(let e of n){if("object"!=typeof e||null===e)continue;let t=e.response;if("object"==typeof t&&null!==t&&void 0!==t.embedding){i=!0;break}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),e}function t3(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error(`Invalid batch job name: ${t}.`)}function t4(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===e)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===e)return"JOB_STATE_EXPIRED";else return e}function t5(e){let t={},n=tt(e,["name"]);null!=n&&te(t,["name"],n);let i=tt(e,["metadata","displayName"]);null!=i&&te(t,["displayName"],i);let l=tt(e,["metadata","state"]);null!=l&&te(t,["state"],t4(l));let r=tt(e,["metadata","createTime"]);null!=r&&te(t,["createTime"],r);let o=tt(e,["metadata","endTime"]);null!=o&&te(t,["endTime"],o);let a=tt(e,["metadata","updateTime"]);null!=a&&te(t,["updateTime"],a);let s=tt(e,["metadata","model"]);null!=s&&te(t,["model"],s);let u=tt(e,["metadata","output"]);return null!=u&&te(t,["dest"],function(e){let t={},n=tt(e,["responsesFile"]);null!=n&&te(t,["fileName"],n);let i=tt(e,["inlinedResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l;return n={},null!=(i=tt(t=e,["response"]))&&te(n,["response"],function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["content"]);null!=n&&te(t,["content"],n);let i=tt(e,["citationMetadata"]);null!=i&&te(t,["citationMetadata"],function(e){let t={},n=tt(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["citations"],e)}return t}(i));let l=tt(e,["tokenCount"]);null!=l&&te(t,["tokenCount"],l);let r=tt(e,["finishReason"]);null!=r&&te(t,["finishReason"],r);let o=tt(e,["avgLogprobs"]);null!=o&&te(t,["avgLogprobs"],o);let a=tt(e,["groundingMetadata"]);null!=a&&te(t,["groundingMetadata"],a);let s=tt(e,["index"]);null!=s&&te(t,["index"],s);let u=tt(e,["logprobsResult"]);null!=u&&te(t,["logprobsResult"],u);let p=tt(e,["safetyRatings"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["safetyRatings"],e)}let d=tt(e,["urlContextMetadata"]);return null!=d&&te(t,["urlContextMetadata"],d),t})(e))),te(t,["candidates"],e)}let l=tt(e,["modelVersion"]);null!=l&&te(t,["modelVersion"],l);let r=tt(e,["promptFeedback"]);null!=r&&te(t,["promptFeedback"],r);let o=tt(e,["responseId"]);null!=o&&te(t,["responseId"],o);let a=tt(e,["usageMetadata"]);return null!=a&&te(t,["usageMetadata"],a),t}(i)),null!=(l=tt(t,["error"]))&&te(n,["error"],l),n})),te(t,["inlinedResponses"],e)}let l=tt(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["inlinedEmbedContentResponses"],e)}return t}(t2(u))),t}function t6(e){var t,n;let i,l,r,o,a,s,u,p,d={},c=tt(e,["name"]);null!=c&&te(d,["name"],c);let h=tt(e,["displayName"]);null!=h&&te(d,["displayName"],h);let m=tt(e,["state"]);null!=m&&te(d,["state"],t4(m));let f=tt(e,["error"]);null!=f&&te(d,["error"],f);let g=tt(e,["createTime"]);null!=g&&te(d,["createTime"],g);let y=tt(e,["startTime"]);null!=y&&te(d,["startTime"],y);let E=tt(e,["endTime"]);null!=E&&te(d,["endTime"],E);let _=tt(e,["updateTime"]);null!=_&&te(d,["updateTime"],_);let v=tt(e,["model"]);null!=v&&te(d,["model"],v);let I=tt(e,["inputConfig"]);null!=I&&te(d,["src"],(i={},null!=(l=tt(n=I,["instancesFormat"]))&&te(i,["format"],l),null!=(r=tt(n,["gcsSource","uris"]))&&te(i,["gcsUri"],r),null!=(o=tt(n,["bigquerySource","inputUri"]))&&te(i,["bigqueryUri"],o),i));let T=tt(e,["outputConfig"]);null!=T&&te(d,["dest"],(t=t2(T),a={},null!=(s=tt(t,["predictionsFormat"]))&&te(a,["format"],s),null!=(u=tt(t,["gcsDestination","outputUriPrefix"]))&&te(a,["gcsUri"],u),null!=(p=tt(t,["bigqueryDestination","outputUri"]))&&te(a,["bigqueryUri"],p),a));let A=tt(e,["completionStats"]);return null!=A&&te(d,["completionStats"],A),d}function t8(e){let t={},n=tt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a,s,u,p,d,c,h;return n={},null!=(i=tt(t=e,["mediaResolution"]))&&te(n,["mediaResolution"],i),null!=(l=tt(t,["codeExecutionResult"]))&&te(n,["codeExecutionResult"],l),null!=(r=tt(t,["executableCode"]))&&te(n,["executableCode"],r),null!=(o=tt(t,["fileData"]))&&te(n,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["fileUri"]);null!=n&&te(t,["fileUri"],n);let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(o)),null!=(a=tt(t,["functionCall"]))&&te(n,["functionCall"],function(e){let t={},n=tt(e,["id"]);null!=n&&te(t,["id"],n);let i=tt(e,["args"]);null!=i&&te(t,["args"],i);let l=tt(e,["name"]);if(null!=l&&te(t,["name"],l),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(a)),null!=(s=tt(t,["functionResponse"]))&&te(n,["functionResponse"],s),null!=(u=tt(t,["inlineData"]))&&te(n,["inlineData"],function(e){let t={},n=tt(e,["data"]);if(null!=n&&te(t,["data"],n),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(u)),null!=(p=tt(t,["text"]))&&te(n,["text"],p),null!=(d=tt(t,["thought"]))&&te(n,["thought"],d),null!=(c=tt(t,["thoughtSignature"]))&&te(n,["thoughtSignature"],c),null!=(h=tt(t,["videoMetadata"]))&&te(n,["videoMetadata"],h),n})),te(t,["parts"],e)}let i=tt(e,["role"]);return null!=i&&te(t,["role"],i),t}function t7(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["_url","model"],tM(e,i));let l=tt(t,["src"]);null!=l&&te(n,["batch","inputConfig"],function(e,t){let n={};if(void 0!==tt(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==tt(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==tt(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let i=tt(t,["fileName"]);null!=i&&te(n,["fileName"],i);let l=tt(t,["inlinedRequests"]);if(null!=l){let t=l;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["request","model"],tM(e,i));let l=tt(t,["contents"]);if(null!=l){let e=tB(l);Array.isArray(e)&&(e=e.map(e=>t8(e))),te(n,["request","contents"],e)}let r=tt(t,["metadata"]);null!=r&&te(n,["metadata"],r);let o=tt(t,["config"]);return null!=o&&te(n,["request","generationConfig"],function(e,t,n){var i;let l,r,o,a={},s=tt(t,["systemInstruction"]);void 0!==n&&null!=s&&te(n,["systemInstruction"],t8(tV(s)));let u=tt(t,["temperature"]);null!=u&&te(a,["temperature"],u);let p=tt(t,["topP"]);null!=p&&te(a,["topP"],p);let d=tt(t,["topK"]);null!=d&&te(a,["topK"],d);let c=tt(t,["candidateCount"]);null!=c&&te(a,["candidateCount"],c);let h=tt(t,["maxOutputTokens"]);null!=h&&te(a,["maxOutputTokens"],h);let m=tt(t,["stopSequences"]);null!=m&&te(a,["stopSequences"],m);let f=tt(t,["responseLogprobs"]);null!=f&&te(a,["responseLogprobs"],f);let g=tt(t,["logprobs"]);null!=g&&te(a,["logprobs"],g);let y=tt(t,["presencePenalty"]);null!=y&&te(a,["presencePenalty"],y);let E=tt(t,["frequencyPenalty"]);null!=E&&te(a,["frequencyPenalty"],E);let _=tt(t,["seed"]);null!=_&&te(a,["seed"],_);let v=tt(t,["responseMimeType"]);null!=v&&te(a,["responseMimeType"],v);let I=tt(t,["responseSchema"]);null!=I&&te(a,["responseSchema"],tJ(I));let T=tt(t,["responseJsonSchema"]);if(null!=T&&te(a,["responseJsonSchema"],T),void 0!==tt(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==tt(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let A=tt(t,["safetySettings"]);if(void 0!==n&&null!=A){let e=A;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["category"]);if(null!=n&&te(t,["category"],n),void 0!==tt(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=tt(e,["threshold"]);return null!=i&&te(t,["threshold"],i),t})(e))),te(n,["safetySettings"],e)}let S=tt(t,["tools"]);if(void 0!==n&&null!=S){let e=t$(S);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let l=tt(e,["computerUse"]);null!=l&&te(t,["computerUse"],l);let r=tt(e,["fileSearch"]);null!=r&&te(t,["fileSearch"],r);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tt(e,["enableWidget"]);return null!=n&&te(t,["enableWidget"],n),t}(a));let s=tt(e,["googleSearch"]);null!=s&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tt(e,["timeRangeFilter"]);return null!=n&&te(t,["timeRangeFilter"],n),t}(s));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tW(e)))),te(n,["tools"],e)}let C=tt(t,["toolConfig"]);if(void 0!==n&&null!=C&&te(n,["toolConfig"],(l={},null!=(r=tt(i=C,["functionCallingConfig"]))&&te(l,["functionCallingConfig"],function(e){let t={},n=tt(e,["mode"]);null!=n&&te(t,["mode"],n);let i=tt(e,["allowedFunctionNames"]);if(null!=i&&te(t,["allowedFunctionNames"],i),void 0!==tt(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r)),null!=(o=tt(i,["retrievalConfig"]))&&te(l,["retrievalConfig"],o),l)),void 0!==tt(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let O=tt(t,["cachedContent"]);void 0!==n&&null!=O&&te(n,["cachedContent"],tz(e,O));let b=tt(t,["responseModalities"]);null!=b&&te(a,["responseModalities"],b);let N=tt(t,["mediaResolution"]);null!=N&&te(a,["mediaResolution"],N);let R=tt(t,["speechConfig"]);if(null!=R&&te(a,["speechConfig"],tY(R)),void 0!==tt(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let P=tt(t,["thinkingConfig"]);null!=P&&te(a,["thinkingConfig"],P);let M=tt(t,["imageConfig"]);return null!=M&&te(a,["imageConfig"],function(e){let t={},n=tt(e,["aspectRatio"]);null!=n&&te(t,["aspectRatio"],n);let i=tt(e,["imageSize"]);if(null!=i&&te(t,["imageSize"],i),void 0!==tt(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(M)),a}(e,o,tt(n,["request"],{}))),n})(e,t))),te(n,["requests","requests"],t)}return n}(e,t1(e,l)));let r=tt(t,["config"]);return null!=r&&function(e,t){let n=tt(e,["displayName"]);if(void 0!==t&&null!=n&&te(t,["batch","displayName"],n),void 0!==tt(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(r,n),n}(el=e6||(e6={})).PAGED_ITEM_BATCH_JOBS="batchJobs",el.PAGED_ITEM_MODELS="models",el.PAGED_ITEM_TUNING_JOBS="tuningJobs",el.PAGED_ITEM_FILES="files",el.PAGED_ITEM_CACHED_CONTENTS="cachedContents",el.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",el.PAGED_ITEM_DOCUMENTS="documents";class t9{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let r={config:{}};(r=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}}).config&&(r.config.pageToken=t.nextPageToken),this.paramsInternal=r,this.pageInternalSize=null!=(l=null==(i=r.config)?void 0:i.pageSize)?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null==(e=this.params.config)?void 0:e.pageToken)!==void 0}}class ne extends e7{constructor(e){super(),this.apiClient=e,this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)},this.list=async(e={})=>new t9(e6.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e)}createInlinedGenerateContentRequest(e){let t=t7(this.apiClient,e),n=e9("{model}:batchGenerateContent",t._url),i=t.batch.inputConfig.requests,l=i.requests,r=[];for(let e of l){let t=Object.assign({},e);if(t.systemInstruction){let e=t.systemInstruction;delete t.systemInstruction;let n=t.request;n.systemInstruction=e,t.request=n}r.push(t)}return i.requests=r,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){let n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),void 0===n.dest){let t=this.getGcsUri(e),l=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest=`${t.slice(0,-6)}/dest`:n.dest=`${t}_dest_${i}`;else if(l)n.dest=`${l}_dest_${i}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,i,l,r;let o="",a={};if(this.apiClient.isVertexAI()){let i,l,s,u,p,d,c=(r=this.apiClient,i={},null!=(l=tt(e,["model"]))&&te(i,["model"],tM(r,l)),null!=(s=tt(e,["src"]))&&te(i,["inputConfig"],function(e){let t={},n=tt(e,["format"]);null!=n&&te(t,["instancesFormat"],n);let i=tt(e,["gcsUri"]);null!=i&&te(t,["gcsSource","uris"],i);let l=tt(e,["bigqueryUri"]);if(null!=l&&te(t,["bigquerySource","inputUri"],l),void 0!==tt(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==tt(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(t1(r,s))),null!=(u=tt(e,["config"]))&&(p=tt(u,["displayName"]),void 0!==i&&null!=p&&te(i,["displayName"],p),d=tt(u,["dest"]),void 0!==i&&null!=d&&te(i,["outputConfig"],function(e){let t={},n=tt(e,["format"]);null!=n&&te(t,["predictionsFormat"],n);let i=tt(e,["gcsUri"]);null!=i&&te(t,["gcsDestination","outputUriPrefix"],i);let l=tt(e,["bigqueryUri"]);if(null!=l&&te(t,["bigqueryDestination","outputUri"],l),void 0!==tt(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==tt(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==tt(e,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error(`Unsupported destination: ${e}`)}(d)))),i);return o=e9("batchPredictionJobs",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>t6(e))}{let t=t7(this.apiClient,e);return o=e9("{model}:batchGenerateContent",t._url),a=t._query,delete t._url,delete t._query,this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>t5(e))}}async createEmbeddingsInternal(e){var t,n,i,l,r;let o="",a={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s,u,p,d,c,h,m,f,g=(i=this.apiClient,d={},null!=(c=tt(e,["model"]))&&te(d,["_url","model"],tM(i,c)),null!=(h=tt(e,["src"]))&&te(d,["batch","inputConfig"],(l=i,s={},null!=(u=tt(r=h,["fileName"]))&&te(s,["file_name"],u),null!=(p=tt(r,["inlinedRequests"]))&&te(s,["requests"],function(e,t){let n={},i=tt(t,["contents"]);if(null!=i){let t=tj(e,i);Array.isArray(t)&&(t=t.map(e=>e)),te(n,["requests[]","request","content"],t)}let l=tt(t,["config"]);return null!=l&&(te(n,["_self"],function(e,t){let n=tt(e,["taskType"]);void 0!==t&&null!=n&&te(t,["requests[]","taskType"],n);let i=tt(e,["title"]);void 0!==t&&null!=i&&te(t,["requests[]","title"],i);let l=tt(e,["outputDimensionality"]);if(void 0!==t&&null!=l&&te(t,["requests[]","outputDimensionality"],l),void 0!==tt(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(l,n)),!function(e,t){for(let[n,i]of Object.entries(t)){let t=n.split("."),l=i.split("."),r=new Set,o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&l.length>o)for(let e=o;e<l.length;e++){let t=l[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||r.add(t)}!function e(t,n,i,l,r){if(l>=n.length||"object"!=typeof t||null===t)return;let o=n[l];if(o.endsWith("[]")){let a=o.slice(0,-2);if(a in t&&Array.isArray(t[a]))for(let o of t[a])e(o,n,i,l+1,r)}else if("*"===o){if("object"==typeof t&&null!==t&&!Array.isArray(t)){let e=Object.keys(t).filter(e=>!e.startsWith("_")&&!r.has(e)),n={};for(let i of e)n[i]=t[i];for(let[e,r]of Object.entries(n)){let n=[];for(let t of i.slice(l))"*"===t?n.push(e):n.push(t);te(t,n,r)}for(let n of e)delete t[n]}}else o in t&&e(t[o],n,i,l+1,r)}(e,t,l,0,r)}}(n,{"requests[].*":"requests[].request.*"})),n}(l,p)),s)),null!=(m=tt(e,["config"]))&&(f=tt(m,["displayName"]),void 0!==d&&null!=f&&te(d,["batch","displayName"],f)),d);return o=e9("{model}:asyncBatchEmbedContent",g._url),a=g._query,delete g._url,delete g._query,this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>t5(e))}}async get(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],t3(r,l)),i);return a=e9("batchPredictionJobs/{name}",o._url),s=o._query,delete o._url,delete o._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>t6(e))}{let t,n,r=(o=this.apiClient,t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],t3(o,n)),t);return a=e9("batches/{name}",r._url),s=r._query,delete r._url,delete r._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>t5(e))}}async cancel(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],t3(r,l)),i);a=e9("batchPredictionJobs/{name}:cancel",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}else{let t,n,r=(o=this.apiClient,t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],t3(o,n)),t);a=e9("batches/{name}:cancel",r._url),s=r._query,delete r._url,delete r._query,await this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal})}}async listInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,a,s,u,p=(i={},null!=(l=tt(e,["config"]))&&(a=tt(l,["pageSize"]),void 0!==i&&null!=a&&te(i,["_query","pageSize"],a),s=tt(l,["pageToken"]),void 0!==i&&null!=s&&te(i,["_query","pageToken"],s),u=tt(l,["filter"]),void 0!==i&&null!=u&&te(i,["_query","filter"],u)),i);return r=e9("batchPredictionJobs",p._url),o=p._query,delete p._url,delete p._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["batchPredictionJobs"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>t6(e))),te(t,["batchJobs"],e)}return t}(e),n=new tb;return Object.assign(n,t),n})}{let t,n,a=(t={},null!=(n=tt(e,["config"]))&&function(e,t){let n=tt(e,["pageSize"]);void 0!==t&&null!=n&&te(t,["_query","pageSize"],n);let i=tt(e,["pageToken"]);if(void 0!==t&&null!=i&&te(t,["_query","pageToken"],i),void 0!==tt(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(n,t),t);return r=e9("batches",a._url),o=a._query,delete a._url,delete a._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["operations"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>t5(e))),te(t,["batchJobs"],e)}return t}(e),n=new tb;return Object.assign(n,t),n})}}async delete(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],t3(r,l)),i);return a=e9("batchPredictionJobs/{name}",o._url),s=o._query,delete o._url,delete o._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r;return t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),null!=(i=tt(e,["name"]))&&te(t,["name"],i),null!=(l=tt(e,["done"]))&&te(t,["done"],l),null!=(r=tt(e,["error"]))&&te(t,["error"],r),t})}{let t,n,r=(o=this.apiClient,t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],t3(o,n)),t);return a=e9("batches/{name}",r._url),s=r._query,delete r._url,delete r._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r;return t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),null!=(i=tt(e,["name"]))&&te(t,["name"],i),null!=(l=tt(e,["done"]))&&te(t,["done"],l),null!=(r=tt(e,["error"]))&&te(t,["error"],r),t})}}}function nt(e){let t={},n=tt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a,s,u,p,d,c,h;return n={},null!=(i=tt(t=e,["mediaResolution"]))&&te(n,["mediaResolution"],i),null!=(l=tt(t,["codeExecutionResult"]))&&te(n,["codeExecutionResult"],l),null!=(r=tt(t,["executableCode"]))&&te(n,["executableCode"],r),null!=(o=tt(t,["fileData"]))&&te(n,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["fileUri"]);null!=n&&te(t,["fileUri"],n);let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(o)),null!=(a=tt(t,["functionCall"]))&&te(n,["functionCall"],function(e){let t={},n=tt(e,["id"]);null!=n&&te(t,["id"],n);let i=tt(e,["args"]);null!=i&&te(t,["args"],i);let l=tt(e,["name"]);if(null!=l&&te(t,["name"],l),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(a)),null!=(s=tt(t,["functionResponse"]))&&te(n,["functionResponse"],s),null!=(u=tt(t,["inlineData"]))&&te(n,["inlineData"],function(e){let t={},n=tt(e,["data"]);if(null!=n&&te(t,["data"],n),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(u)),null!=(p=tt(t,["text"]))&&te(n,["text"],p),null!=(d=tt(t,["thought"]))&&te(n,["thought"],d),null!=(c=tt(t,["thoughtSignature"]))&&te(n,["thoughtSignature"],c),null!=(h=tt(t,["videoMetadata"]))&&te(n,["videoMetadata"],h),n})),te(t,["parts"],e)}let i=tt(e,["role"]);return null!=i&&te(t,["role"],i),t}class nn extends e7{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new t9(e6.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o,u=(r=this.apiClient,i={},null!=(l=tt(e,["model"]))&&te(i,["model"],tw(r,l)),null!=(o=tt(e,["config"]))&&function(e,t){let n=tt(e,["ttl"]);void 0!==t&&null!=n&&te(t,["ttl"],n);let i=tt(e,["expireTime"]);void 0!==t&&null!=i&&te(t,["expireTime"],i);let l=tt(e,["displayName"]);void 0!==t&&null!=l&&te(t,["displayName"],l);let r=tt(e,["contents"]);if(void 0!==t&&null!=r){let e=tB(r);Array.isArray(e)&&(e=e.map(e=>e)),te(t,["contents"],e)}let o=tt(e,["systemInstruction"]);void 0!==t&&null!=o&&te(t,["systemInstruction"],tV(o));let a=tt(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tt(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=tt(e,["description"]);null!=n&&te(t,["description"],n);let i=tt(e,["name"]);null!=i&&te(t,["name"],i);let l=tt(e,["parameters"]);null!=l&&te(t,["parameters"],l);let r=tt(e,["parametersJsonSchema"]);null!=r&&te(t,["parametersJsonSchema"],r);let o=tt(e,["response"]);null!=o&&te(t,["response"],o);let a=tt(e,["responseJsonSchema"]);return null!=a&&te(t,["responseJsonSchema"],a),t})(e))),te(t,["functionDeclarations"],e)}let i=tt(e,["retrieval"]);null!=i&&te(t,["retrieval"],i);let l=tt(e,["googleSearchRetrieval"]);null!=l&&te(t,["googleSearchRetrieval"],l);let r=tt(e,["computerUse"]);if(null!=r&&te(t,["computerUse"],r),void 0!==tt(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tt(e,["codeExecution"]);null!=o&&te(t,["codeExecution"],o);let a=tt(e,["enterpriseWebSearch"]);null!=a&&te(t,["enterpriseWebSearch"],a);let s=tt(e,["googleMaps"]);null!=s&&te(t,["googleMaps"],s);let u=tt(e,["googleSearch"]);null!=u&&te(t,["googleSearch"],u);let p=tt(e,["urlContext"]);return null!=p&&te(t,["urlContext"],p),t})(e))),te(t,["tools"],e)}let s=tt(e,["toolConfig"]);void 0!==t&&null!=s&&te(t,["toolConfig"],s);let u=tt(e,["kmsKeyName"]);void 0!==t&&null!=u&&te(t,["encryption_spec","kmsKeyName"],u)}(o,i),i);return a=e9("cachedContents",u._url),s=u._query,delete u._url,delete u._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,r,u=(o=this.apiClient,t={},null!=(n=tt(e,["model"]))&&te(t,["model"],tw(o,n)),null!=(r=tt(e,["config"]))&&function(e,t){var n;let i,l,r,o=tt(e,["ttl"]);void 0!==t&&null!=o&&te(t,["ttl"],o);let a=tt(e,["expireTime"]);void 0!==t&&null!=a&&te(t,["expireTime"],a);let s=tt(e,["displayName"]);void 0!==t&&null!=s&&te(t,["displayName"],s);let u=tt(e,["contents"]);if(void 0!==t&&null!=u){let e=tB(u);Array.isArray(e)&&(e=e.map(e=>nt(e))),te(t,["contents"],e)}let p=tt(e,["systemInstruction"]);void 0!==t&&null!=p&&te(t,["systemInstruction"],nt(tV(p)));let d=tt(e,["tools"]);if(void 0!==t&&null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let l=tt(e,["computerUse"]);null!=l&&te(t,["computerUse"],l);let r=tt(e,["fileSearch"]);null!=r&&te(t,["fileSearch"],r);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tt(e,["enableWidget"]);return null!=n&&te(t,["enableWidget"],n),t}(a));let s=tt(e,["googleSearch"]);null!=s&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tt(e,["timeRangeFilter"]);return null!=n&&te(t,["timeRangeFilter"],n),t}(s));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(e))),te(t,["tools"],e)}let c=tt(e,["toolConfig"]);if(void 0!==t&&null!=c&&te(t,["toolConfig"],(i={},null!=(l=tt(n=c,["functionCallingConfig"]))&&te(i,["functionCallingConfig"],function(e){let t={},n=tt(e,["mode"]);null!=n&&te(t,["mode"],n);let i=tt(e,["allowedFunctionNames"]);if(null!=i&&te(t,["allowedFunctionNames"],i),void 0!==tt(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(l)),null!=(r=tt(n,["retrievalConfig"]))&&te(i,["retrievalConfig"],r),i)),void 0!==tt(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(r,t),t);return a=e9("cachedContents",u._url),s=u._query,delete u._url,delete u._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],tz(r,l)),i);return a=e9("{name}",o._url),s=o._query,delete o._url,delete o._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,r=(o=this.apiClient,t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],tz(o,n)),t);return a=e9("{name}",r._url),s=r._query,delete r._url,delete r._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],tz(r,l)),i);return a=e9("{name}",o._url),s=o._query,delete o._url,delete o._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),t),l=new tE;return Object.assign(l,i),l})}{let t,n,r=(o=this.apiClient,t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],tz(o,n)),t);return a=e9("{name}",r._url),s=r._query,delete r._url,delete r._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),t),l=new tE;return Object.assign(l,i),l})}}async update(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d=(r=this.apiClient,i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],tz(r,l)),null!=(o=tt(e,["config"]))&&(u=tt(o,["ttl"]),void 0!==i&&null!=u&&te(i,["ttl"],u),p=tt(o,["expireTime"]),void 0!==i&&null!=p&&te(i,["expireTime"],p)),i);return a=e9("{name}",d._url),s=d._query,delete d._url,delete d._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,r,u,p,d=(o=this.apiClient,t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],tz(o,n)),null!=(r=tt(e,["config"]))&&(u=tt(r,["ttl"]),void 0!==t&&null!=u&&te(t,["ttl"],u),p=tt(r,["expireTime"]),void 0!==t&&null!=p&&te(t,["expireTime"],p)),t);return a=e9("{name}",d._url),s=d._query,delete d._url,delete d._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>e)}}async listInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,a,s,u=(i={},null!=(l=tt(e,["config"]))&&(a=tt(l,["pageSize"]),void 0!==i&&null!=a&&te(i,["_query","pageSize"],a),s=tt(l,["pageToken"]),void 0!==i&&null!=s&&te(i,["_query","pageToken"],s)),i);return r=e9("cachedContents",u._url),o=u._query,delete u._url,delete u._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["cachedContents"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["cachedContents"],e)}return t}(e),n=new t_;return Object.assign(n,t),n})}{let t,n,a,s,u=(t={},null!=(n=tt(e,["config"]))&&(a=tt(n,["pageSize"]),void 0!==t&&null!=a&&te(t,["_query","pageSize"],a),s=tt(n,["pageToken"]),void 0!==t&&null!=s&&te(t,["_query","pageToken"],s)),t);return r=e9("cachedContents",u._url),o=u._query,delete u._url,delete u._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["cachedContents"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["cachedContents"],e)}return t}(e),n=new t_;return Object.assign(n,t),n})}}}function ni(e){return this instanceof ni?(this.v=e,this):new ni(e)}function nl(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,l=n.apply(e,t||[]),r=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),i[Symbol.asyncIterator]=function(){return this},i;function o(e,t){l[e]&&(i[e]=function(t){return new Promise(function(n,i){r.push([e,t,n,i])>1||a(e,t)})},t&&(i[e]=t(i[e])))}function a(e,t){try{var n;(n=l[e](t)).value instanceof ni?Promise.resolve(n.value.v).then(s,u):p(r[0][2],n)}catch(e){p(r[0][3],e)}}function s(e){a("next",e)}function u(e){a("throw",e)}function p(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function nr(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,l){var r,o,a;r=i,o=l,a=(t=e[n](t)).done,Promise.resolve(t.value).then(function(e){r({value:e,done:a})},o)})}}}function no(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function na(e){if(void 0===e||0===e.length)return[];let t=[],n=e.length,i=0;for(;i<n;)if("user"===e[i].role)t.push(e[i]),i++;else{let l=[],r=!0;for(;i<n&&"model"===e[i].role;)l.push(e[i]),r&&!no(e[i])&&(r=!1),i++;r?t.push(...l):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class ns{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new nu(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class nu{constructor(e,t,n,i={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(l)}async sendMessage(e){var t;await this.sendPromise;let n=tV(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});return this.sendPromise=(async()=>{var e,t,l;let r=await i,o=null==(t=null==(e=r.candidates)?void 0:e[0])?void 0:t.content,a=r.automaticFunctionCallingHistory,s=this.getHistory(!0).length,u=[];null!=a&&(u=null!=(l=a.slice(s))?l:[]),this.recordHistory(n,o?[o]:[],u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;let n=tV(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});this.sendPromise=i.then(()=>void 0).catch(()=>void 0);let l=await i;return this.processStreamResponse(l,n)}getHistory(e=!1){return structuredClone(e?na(this.history):this.history)}processStreamResponse(e,t){var n,i;return nl(this,arguments,function*(){var l,r,o,a;let s=[];try{for(var u,p=!0,d=nr(e);!(l=(u=yield ni(d.next())).done);p=!0){if(a=u.value,p=!1,function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let n=null==(t=e.candidates[0])?void 0:t.content;return void 0!==n&&no(n)}(a)){let e=null==(i=null==(n=a.candidates)?void 0:n[0])?void 0:i.content;void 0!==e&&s.push(e)}yield yield ni(a)}}catch(e){r={error:e}}finally{try{!p&&!l&&(o=d.return)&&(yield ni(o.call(d)))}finally{if(r)throw r.error}}this.recordHistory(t,s)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(e=>void 0!==e.role)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...na(n)):this.history.push(e),this.history.push(...i)}}class np extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,np.prototype)}}class nd extends e7{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new t9(e6.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s,u=(r={},null!=(o=tt(e,["config"]))&&(a=tt(o,["pageSize"]),void 0!==r&&null!=a&&te(r,["_query","pageSize"],a),s=tt(o,["pageToken"]),void 0!==r&&null!=s&&te(r,["_query","pageToken"],s)),r);return i=e9("files",u._url),l=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["files"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["files"],e)}return t}(e),n=new tS;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a=(r={},null!=(o=tt(e,["file"]))&&te(r,["file"],o),r);return i=e9("upload/v1beta/files",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),t),l=new tC;return Object.assign(l,i),l})}}async get(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a=(r={},null!=(o=tt(e,["name"]))&&te(r,["_url","file"],tQ(o)),r);return i=e9("files/{file}",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a=(r={},null!=(o=tt(e,["name"]))&&te(r,["_url","file"],tQ(o)),r);return i=e9("files/{file}",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),t),l=new tO;return Object.assign(l,i),l})}}}function nc(e){let t={},n=tt(e,["data"]);if(null!=n&&te(t,["data"],n),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}function nh(e){let t={},n=tt(e,["languageCode"]);null!=n&&te(t,["languageCode"],n);let i=tt(e,["voiceConfig"]);if(null!=i&&te(t,["voiceConfig"],i),void 0!==tt(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function nm(e){let t={},n=tt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a,s,u,p,d,c,h;return n={},null!=(i=tt(t=e,["mediaResolution"]))&&te(n,["mediaResolution"],i),null!=(l=tt(t,["codeExecutionResult"]))&&te(n,["codeExecutionResult"],l),null!=(r=tt(t,["executableCode"]))&&te(n,["executableCode"],r),null!=(o=tt(t,["fileData"]))&&te(n,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["fileUri"]);null!=n&&te(t,["fileUri"],n);let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(o)),null!=(a=tt(t,["functionCall"]))&&te(n,["functionCall"],function(e){let t={},n=tt(e,["id"]);null!=n&&te(t,["id"],n);let i=tt(e,["args"]);null!=i&&te(t,["args"],i);let l=tt(e,["name"]);if(null!=l&&te(t,["name"],l),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(a)),null!=(s=tt(t,["functionResponse"]))&&te(n,["functionResponse"],s),null!=(u=tt(t,["inlineData"]))&&te(n,["inlineData"],function(e){let t={},n=tt(e,["data"]);if(null!=n&&te(t,["data"],n),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(u)),null!=(p=tt(t,["text"]))&&te(n,["text"],p),null!=(d=tt(t,["thought"]))&&te(n,["thought"],d),null!=(c=tt(t,["thoughtSignature"]))&&te(n,["thoughtSignature"],c),null!=(h=tt(t,["videoMetadata"]))&&te(n,["videoMetadata"],h),n})),te(t,["parts"],e)}let i=tt(e,["role"]);return null!=i&&te(t,["role"],i),t}function nf(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["_url","model"],tM(e,i));let l=tt(t,["contents"]);if(null!=l){let e=tB(l);Array.isArray(e)&&(e=e.map(e=>nm(e))),te(n,["contents"],e)}let r=tt(t,["config"]);return null!=r&&te(n,["generationConfig"],function(e,t,n){var i;let l,r,o,a={},s=tt(t,["systemInstruction"]);void 0!==n&&null!=s&&te(n,["systemInstruction"],nm(tV(s)));let u=tt(t,["temperature"]);null!=u&&te(a,["temperature"],u);let p=tt(t,["topP"]);null!=p&&te(a,["topP"],p);let d=tt(t,["topK"]);null!=d&&te(a,["topK"],d);let c=tt(t,["candidateCount"]);null!=c&&te(a,["candidateCount"],c);let h=tt(t,["maxOutputTokens"]);null!=h&&te(a,["maxOutputTokens"],h);let m=tt(t,["stopSequences"]);null!=m&&te(a,["stopSequences"],m);let f=tt(t,["responseLogprobs"]);null!=f&&te(a,["responseLogprobs"],f);let g=tt(t,["logprobs"]);null!=g&&te(a,["logprobs"],g);let y=tt(t,["presencePenalty"]);null!=y&&te(a,["presencePenalty"],y);let E=tt(t,["frequencyPenalty"]);null!=E&&te(a,["frequencyPenalty"],E);let _=tt(t,["seed"]);null!=_&&te(a,["seed"],_);let v=tt(t,["responseMimeType"]);null!=v&&te(a,["responseMimeType"],v);let I=tt(t,["responseSchema"]);null!=I&&te(a,["responseSchema"],tJ(I));let T=tt(t,["responseJsonSchema"]);if(null!=T&&te(a,["responseJsonSchema"],T),void 0!==tt(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==tt(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let A=tt(t,["safetySettings"]);if(void 0!==n&&null!=A){let e=A;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["category"]);if(null!=n&&te(t,["category"],n),void 0!==tt(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=tt(e,["threshold"]);return null!=i&&te(t,["threshold"],i),t})(e))),te(n,["safetySettings"],e)}let S=tt(t,["tools"]);if(void 0!==n&&null!=S){let e=t$(S);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let l=tt(e,["computerUse"]);null!=l&&te(t,["computerUse"],l);let r=tt(e,["fileSearch"]);null!=r&&te(t,["fileSearch"],r);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tt(e,["enableWidget"]);return null!=n&&te(t,["enableWidget"],n),t}(a));let s=tt(e,["googleSearch"]);null!=s&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tt(e,["timeRangeFilter"]);return null!=n&&te(t,["timeRangeFilter"],n),t}(s));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tW(e)))),te(n,["tools"],e)}let C=tt(t,["toolConfig"]);if(void 0!==n&&null!=C&&te(n,["toolConfig"],(l={},null!=(r=tt(i=C,["functionCallingConfig"]))&&te(l,["functionCallingConfig"],function(e){let t={},n=tt(e,["mode"]);null!=n&&te(t,["mode"],n);let i=tt(e,["allowedFunctionNames"]);if(null!=i&&te(t,["allowedFunctionNames"],i),void 0!==tt(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r)),null!=(o=tt(i,["retrievalConfig"]))&&te(l,["retrievalConfig"],o),l)),void 0!==tt(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let O=tt(t,["cachedContent"]);void 0!==n&&null!=O&&te(n,["cachedContent"],tz(e,O));let b=tt(t,["responseModalities"]);null!=b&&te(a,["responseModalities"],b);let N=tt(t,["mediaResolution"]);null!=N&&te(a,["mediaResolution"],N);let R=tt(t,["speechConfig"]);if(null!=R&&te(a,["speechConfig"],tY(R)),void 0!==tt(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let P=tt(t,["thinkingConfig"]);null!=P&&te(a,["thinkingConfig"],P);let M=tt(t,["imageConfig"]);return null!=M&&te(a,["imageConfig"],function(e){let t={},n=tt(e,["aspectRatio"]);null!=n&&te(t,["aspectRatio"],n);let i=tt(e,["imageSize"]);if(null!=i&&te(t,["imageSize"],i),void 0!==tt(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(M)),a}(e,r,n)),n}function ng(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["_url","model"],tM(e,i));let l=tt(t,["contents"]);if(null!=l){let e=tB(l);Array.isArray(e)&&(e=e.map(e=>e)),te(n,["contents"],e)}let r=tt(t,["config"]);return null!=r&&te(n,["generationConfig"],function(e,t,n){var i;let l,r,o,a,s,u={},p=tt(t,["systemInstruction"]);void 0!==n&&null!=p&&te(n,["systemInstruction"],tV(p));let d=tt(t,["temperature"]);null!=d&&te(u,["temperature"],d);let c=tt(t,["topP"]);null!=c&&te(u,["topP"],c);let h=tt(t,["topK"]);null!=h&&te(u,["topK"],h);let m=tt(t,["candidateCount"]);null!=m&&te(u,["candidateCount"],m);let f=tt(t,["maxOutputTokens"]);null!=f&&te(u,["maxOutputTokens"],f);let g=tt(t,["stopSequences"]);null!=g&&te(u,["stopSequences"],g);let y=tt(t,["responseLogprobs"]);null!=y&&te(u,["responseLogprobs"],y);let E=tt(t,["logprobs"]);null!=E&&te(u,["logprobs"],E);let _=tt(t,["presencePenalty"]);null!=_&&te(u,["presencePenalty"],_);let v=tt(t,["frequencyPenalty"]);null!=v&&te(u,["frequencyPenalty"],v);let I=tt(t,["seed"]);null!=I&&te(u,["seed"],I);let T=tt(t,["responseMimeType"]);null!=T&&te(u,["responseMimeType"],T);let A=tt(t,["responseSchema"]);null!=A&&te(u,["responseSchema"],tJ(A));let S=tt(t,["responseJsonSchema"]);null!=S&&te(u,["responseJsonSchema"],S);let C=tt(t,["routingConfig"]);null!=C&&te(u,["routingConfig"],C);let O=tt(t,["modelSelectionConfig"]);null!=O&&te(u,["modelConfig"],O);let b=tt(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>e)),te(n,["safetySettings"],e)}let N=tt(t,["tools"]);if(void 0!==n&&null!=N){let e=t$(N);Array.isArray(e)&&(e=e.map(e=>nN(tW(e)))),te(n,["tools"],e)}let R=tt(t,["toolConfig"]);void 0!==n&&null!=R&&te(n,["toolConfig"],R);let P=tt(t,["labels"]);void 0!==n&&null!=P&&te(n,["labels"],P);let M=tt(t,["cachedContent"]);void 0!==n&&null!=M&&te(n,["cachedContent"],tz(e,M));let w=tt(t,["responseModalities"]);null!=w&&te(u,["responseModalities"],w);let D=tt(t,["mediaResolution"]);null!=D&&te(u,["mediaResolution"],D);let U=tt(t,["speechConfig"]);null!=U&&te(u,["speechConfig"],nb(tY(U)));let q=tt(t,["audioTimestamp"]);null!=q&&te(u,["audioTimestamp"],q);let k=tt(t,["thinkingConfig"]);null!=k&&te(u,["thinkingConfig"],k);let x=tt(t,["imageConfig"]);return null!=x&&te(u,["imageConfig"],(l={},null!=(r=tt(i=x,["aspectRatio"]))&&te(l,["aspectRatio"],r),null!=(o=tt(i,["imageSize"]))&&te(l,["imageSize"],o),null!=(a=tt(i,["outputMimeType"]))&&te(l,["imageOutputOptions","mimeType"],a),null!=(s=tt(i,["outputCompressionQuality"]))&&te(l,["imageOutputOptions","compressionQuality"],s),l)),u}(e,r,n)),n}function ny(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["content"]);null!=n&&te(t,["content"],n);let i=tt(e,["citationMetadata"]);null!=i&&te(t,["citationMetadata"],function(e){let t={},n=tt(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["citations"],e)}return t}(i));let l=tt(e,["tokenCount"]);null!=l&&te(t,["tokenCount"],l);let r=tt(e,["finishReason"]);null!=r&&te(t,["finishReason"],r);let o=tt(e,["avgLogprobs"]);null!=o&&te(t,["avgLogprobs"],o);let a=tt(e,["groundingMetadata"]);null!=a&&te(t,["groundingMetadata"],a);let s=tt(e,["index"]);null!=s&&te(t,["index"],s);let u=tt(e,["logprobsResult"]);null!=u&&te(t,["logprobsResult"],u);let p=tt(e,["safetyRatings"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["safetyRatings"],e)}let d=tt(e,["urlContextMetadata"]);return null!=d&&te(t,["urlContextMetadata"],d),t})(e))),te(t,["candidates"],e)}let l=tt(e,["modelVersion"]);null!=l&&te(t,["modelVersion"],l);let r=tt(e,["promptFeedback"]);null!=r&&te(t,["promptFeedback"],r);let o=tt(e,["responseId"]);null!=o&&te(t,["responseId"],o);let a=tt(e,["usageMetadata"]);return null!=a&&te(t,["usageMetadata"],a),t}function nE(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["candidates"],e)}let l=tt(e,["createTime"]);null!=l&&te(t,["createTime"],l);let r=tt(e,["modelVersion"]);null!=r&&te(t,["modelVersion"],r);let o=tt(e,["promptFeedback"]);null!=o&&te(t,["promptFeedback"],o);let a=tt(e,["responseId"]);null!=a&&te(t,["responseId"],a);let s=tt(e,["usageMetadata"]);return null!=s&&te(t,["usageMetadata"],s),t}function n_(e){let t={},n=tt(e,["_self"]);null!=n&&te(t,["image"],nv(n));let i=tt(e,["raiFilteredReason"]);null!=i&&te(t,["raiFilteredReason"],i);let l=tt(e,["_self"]);null!=l&&te(t,["safetyAttributes"],nO(l));let r=tt(e,["prompt"]);return null!=r&&te(t,["enhancedPrompt"],r),t}function nv(e){let t={},n=tt(e,["gcsUri"]);null!=n&&te(t,["gcsUri"],n);let i=tt(e,["bytesBase64Encoded"]);null!=i&&te(t,["imageBytes"],tn(i));let l=tt(e,["mimeType"]);return null!=l&&te(t,["mimeType"],l),t}function nI(e){let t={};if(void 0!==tt(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let n=tt(e,["imageBytes"]);null!=n&&te(t,["bytesBase64Encoded"],tn(n));let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}function nT(e){let t={},n=tt(e,["gcsUri"]);null!=n&&te(t,["gcsUri"],n);let i=tt(e,["imageBytes"]);null!=i&&te(t,["bytesBase64Encoded"],tn(i));let l=tt(e,["mimeType"]);return null!=l&&te(t,["mimeType"],l),t}function nA(e){var t;let n,i,l,r,o={},a=tt(e,["name"]);null!=a&&te(o,["name"],a);let s=tt(e,["displayName"]);null!=s&&te(o,["displayName"],s);let u=tt(e,["description"]);null!=u&&te(o,["description"],u);let p=tt(e,["version"]);null!=p&&te(o,["version"],p);let d=tt(e,["_self"]);null!=d&&te(o,["tunedModelInfo"],(n={},null!=(i=tt(t=d,["baseModel"]))&&te(n,["baseModel"],i),null!=(l=tt(t,["createTime"]))&&te(n,["createTime"],l),null!=(r=tt(t,["updateTime"]))&&te(n,["updateTime"],r),n));let c=tt(e,["inputTokenLimit"]);null!=c&&te(o,["inputTokenLimit"],c);let h=tt(e,["outputTokenLimit"]);null!=h&&te(o,["outputTokenLimit"],h);let m=tt(e,["supportedGenerationMethods"]);null!=m&&te(o,["supportedActions"],m);let f=tt(e,["temperature"]);null!=f&&te(o,["temperature"],f);let g=tt(e,["maxTemperature"]);null!=g&&te(o,["maxTemperature"],g);let y=tt(e,["topP"]);null!=y&&te(o,["topP"],y);let E=tt(e,["topK"]);null!=E&&te(o,["topK"],E);let _=tt(e,["thinking"]);return null!=_&&te(o,["thinking"],_),o}function nS(e){var t;let n,i,l,r,o={},a=tt(e,["name"]);null!=a&&te(o,["name"],a);let s=tt(e,["displayName"]);null!=s&&te(o,["displayName"],s);let u=tt(e,["description"]);null!=u&&te(o,["description"],u);let p=tt(e,["versionId"]);null!=p&&te(o,["version"],p);let d=tt(e,["deployedModels"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>{let t,n,i;return t={},null!=(n=tt(e,["endpoint"]))&&te(t,["name"],n),null!=(i=tt(e,["deployedModelId"]))&&te(t,["deployedModelId"],i),t})),te(o,["endpoints"],e)}let c=tt(e,["labels"]);null!=c&&te(o,["labels"],c);let h=tt(e,["_self"]);null!=h&&te(o,["tunedModelInfo"],(n={},null!=(i=tt(t=h,["labels","google-vertex-llm-tuning-base-model-id"]))&&te(n,["baseModel"],i),null!=(l=tt(t,["createTime"]))&&te(n,["createTime"],l),null!=(r=tt(t,["updateTime"]))&&te(n,["updateTime"],r),n));let m=tt(e,["defaultCheckpointId"]);null!=m&&te(o,["defaultCheckpointId"],m);let f=tt(e,["checkpoints"]);if(null!=f){let e=f;Array.isArray(e)&&(e=e.map(e=>e)),te(o,["checkpoints"],e)}return o}function nC(e){let t={},n=tt(e,["safetyAttributes","categories"]);null!=n&&te(t,["categories"],n);let i=tt(e,["safetyAttributes","scores"]);null!=i&&te(t,["scores"],i);let l=tt(e,["contentType"]);return null!=l&&te(t,["contentType"],l),t}function nO(e){let t={},n=tt(e,["safetyAttributes","categories"]);null!=n&&te(t,["categories"],n);let i=tt(e,["safetyAttributes","scores"]);null!=i&&te(t,["scores"],i);let l=tt(e,["contentType"]);return null!=l&&te(t,["contentType"],l),t}function nb(e){let t={},n=tt(e,["languageCode"]);null!=n&&te(t,["languageCode"],n);let i=tt(e,["voiceConfig"]);if(null!=i&&te(t,["voiceConfig"],i),void 0!==tt(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function nN(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tt(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=tt(e,["description"]);null!=n&&te(t,["description"],n);let i=tt(e,["name"]);null!=i&&te(t,["name"],i);let l=tt(e,["parameters"]);null!=l&&te(t,["parameters"],l);let r=tt(e,["parametersJsonSchema"]);null!=r&&te(t,["parametersJsonSchema"],r);let o=tt(e,["response"]);null!=o&&te(t,["response"],o);let a=tt(e,["responseJsonSchema"]);return null!=a&&te(t,["responseJsonSchema"],a),t})(e))),te(t,["functionDeclarations"],e)}let i=tt(e,["retrieval"]);null!=i&&te(t,["retrieval"],i);let l=tt(e,["googleSearchRetrieval"]);null!=l&&te(t,["googleSearchRetrieval"],l);let r=tt(e,["computerUse"]);if(null!=r&&te(t,["computerUse"],r),void 0!==tt(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tt(e,["codeExecution"]);null!=o&&te(t,["codeExecution"],o);let a=tt(e,["enterpriseWebSearch"]);null!=a&&te(t,["enterpriseWebSearch"],a);let s=tt(e,["googleMaps"]);null!=s&&te(t,["googleMaps"],s);let u=tt(e,["googleSearch"]);null!=u&&te(t,["googleSearch"],u);let p=tt(e,["urlContext"]);return null!=p&&te(t,["urlContext"],p),t}function nR(e){let t={},n=tt(e,["uri"]);null!=n&&te(t,["uri"],n);let i=tt(e,["videoBytes"]);null!=i&&te(t,["encodedVideo"],tn(i));let l=tt(e,["mimeType"]);return null!=l&&te(t,["encoding"],l),t}function nP(e){let t={},n=tt(e,["uri"]);null!=n&&te(t,["gcsUri"],n);let i=tt(e,["videoBytes"]);null!=i&&te(t,["bytesBase64Encoded"],tn(i));let l=tt(e,["mimeType"]);return null!=l&&te(t,["mimeType"],l),t}let nM="x-goog-api-client",nw=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class nD{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=null!=(t=this.clientOptions.apiVersion)?t:"v1beta1",i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=null!=(n=this.clientOptions.apiVersion)?n:"v1beta",i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!=(e=this.clientOptions.vertexai)&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,n){let i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),""!==e&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(let[t,n]of Object.entries(e.queryParams))i.searchParams.append(t,String(n));let l={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,i.toString(),e.abortSignal),this.unaryApiCall(i,l,e.httpMethod)}patchHttpOptions(e,t){let n=JSON.parse(JSON.stringify(e));for(let[e,i]of Object.entries(t))"object"==typeof i?n[e]=Object.assign(Object.assign({},n[e]),i):void 0!==i&&(n[e]=i);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);i.searchParams.has("alt")&&"sse"===i.searchParams.get("alt")||i.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,i.toString(),e.abortSignal),this.streamApiCall(i,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){let n=new AbortController,l=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}i&&i.addEventListener("abort",()=>{n.abort()}),e.signal=l}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let n={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");n=t}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}e.body=JSON.stringify(function e(t,n){let i=Object.assign({},t);for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let l=n[t],r=i[t];l&&"object"==typeof l&&!Array.isArray(l)&&r&&"object"==typeof r&&!Array.isArray(r)?i[t]=e(r,l):(r&&l&&typeof r!=typeof l&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof r}, New type: ${typeof l}. Overwriting.`),i[t]=l)}return i}(n,t))}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await nU(e),new tl(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await nU(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){var t;return nl(this,arguments,function*(){let n=null==(t=null==e?void 0:e.body)?void 0:t.getReader(),i=new TextDecoder("utf-8");if(!n)throw Error("Response body is empty");try{let t="";for(;;){let{done:l,value:r}=yield ni(n.read());if(l){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let o=i.decode(r,{stream:!0});try{let e=JSON.parse(o);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),n=t.status,i=t.code,l=`got status: ${n}. ${JSON.stringify(e)}`;if(i>=400&&i<600)throw new np({message:l,status:i})}}catch(e){if("ApiError"===e.name)throw e}let a=(t+=o).match(nw);for(;a;){let n=a[1];try{let i=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield ni(new tl(i)),a=(t=t.slice(a[0].length)).match(nw)}catch(e){throw Error(`exception parsing stream chunk ${n}. ${e}`)}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/1.30.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[nM]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){let n=new Headers;if(e&&e.headers){for(let[t,i]of Object.entries(e.headers))n.append(t,i);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"==typeof e&&(n=null!=(t=(n=e.replace(/[/\\]+$/,"")).split(/[/\\]/).pop())?t:""),n}async uploadFile(e,t){var n;let i={};null!=t&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);let l=this.clientOptions.uploader,r=await l.stat(e);i.sizeBytes=String(r.size);let o=null!=(n=null==t?void 0:t.mimeType)?n:r.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;let a={file:i},s=this.getFileName(e),u=e9("upload/v1beta/files",a._url),p=await this.fetchUploadUrl(u,i.sizeBytes,i.mimeType,s,a,null==t?void 0:t.httpOptions);return l.upload(e,p,this)}async uploadFileToFileSearchStore(e,t,n){var i;let l=this.clientOptions.uploader,r=await l.stat(t),o=String(r.size),a=null!=(i=null==n?void 0:n.mimeType)?i:r.type;if(void 0===a||""===a)throw Error("Can not determine mimeType. Please provide mimeType in the config.");let s=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(t),p={};(null==n?void 0:n.customMetadata)&&(p.customMetadata=n.customMetadata),(null==n?void 0:n.chunkingConfig)&&(p.chunkingConfig=n.chunkingConfig);let d=await this.fetchUploadUrl(s,o,a,u,p,null==n?void 0:n.httpOptions);return l.uploadToFileSearchStore(t,d,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,i,l,r){var o;let a={};a=r||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};let s=await this.request({path:e,body:JSON.stringify(l),httpMethod:"POST",httpOptions:a});if(!s||!(null==s?void 0:s.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let u=null==(o=null==s?void 0:s.headers)?void 0:o["x-goog-upload-url"];if(void 0===u)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function nU(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let n=e.status,i=JSON.stringify((null==(t=e.headers.get("content-type"))?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(n>=400&&n<600)throw new np({message:i,status:n});throw Error(i)}}function nq(e){for(let n of e){var t;if(null!==(t=n)&&"object"==typeof t&&t instanceof nx||"object"==typeof n&&"inputSchema"in n)return!0}return!1}function nk(e){var t;let n=null!=(t=e[nM])?t:"";e[nM]=(n+" mcp_used/unknown").trimStart()}class nx{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new nx(e,t)}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;let l={},r=[];for(let u of this.mcpClients)try{for(var o,a=!0,s=(t=void 0,nr(function(e,t=100){return nl(this,arguments,function*(){let n,i=0;for(;i<t;){let t=yield ni(e.listTools({cursor:n}));for(let e of t.tools)yield yield ni(e),i++;if(!t.nextCursor)break;n=t.nextCursor}})}(u)));!(e=(o=await s.next()).done);a=!0){i=o.value,a=!1,r.push(i);let e=i.name;if(l[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);l[e]=u}}catch(e){t={error:e}}finally{try{!a&&!e&&(n=s.return)&&await n.call(s)}finally{if(t)throw t.error}}this.mcpTools=r,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),function(e,t={}){let n=[],i=new Set;for(let l of e){let e=l.name;if(i.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i.add(e);let r=function(e,t={}){let n={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(n.responseJsonSchema=e.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}(l,t);r.functionDeclarations&&n.push(...r.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let n of e)if(n.name in this.functionNameToMcpClient){let e,i=this.functionNameToMcpClient[n.name];this.config.timeout&&(e={timeout:this.config.timeout});let l=await i.callTool({name:n.name,arguments:n.args},void 0,e);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}async function nL(e,t,n){let i=new tR;Object.assign(i,n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data)),t(i)}class nG{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;let i;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let l=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t}(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),s=`${l}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${a}`,u=()=>{},p=new Promise(e=>{u=e}),d=e.callbacks,c=this.apiClient,h={onopen:function(){u({})},onmessage:e=>{nL(c,d.onmessage,e)},onerror:null!=(t=null==d?void 0:d.onerror)?t:function(e){},onclose:null!=(n=null==d?void 0:d.onclose)?n:function(e){}},m=this.webSocketFactory.create(s,(i={},o.forEach((e,t)=>{i[t]=e}),i),h);m.connect(),await p;let f=tM(this.apiClient,e.model);return m.send(JSON.stringify({setup:{model:f}})),new nF(m,this.apiClient)}}class nF{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=function(e){let t={},n=tt(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){let t,n;e.musicGenerationConfig||(e.musicGenerationConfig={});let i=(t={},null!=(n=tt(e,["musicGenerationConfig"]))&&te(t,["musicGenerationConfig"],n),t);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){this.conn.send(JSON.stringify({playbackControl:e}))}play(){this.sendPlaybackControl(e5.PLAY)}pause(){this.sendPlaybackControl(e5.PAUSE)}stop(){this.sendPlaybackControl(e5.STOP)}resetContext(){this.sendPlaybackControl(e5.RESET_CONTEXT)}close(){this.conn.close()}}async function nH(e,t,n){let i=new tN,l=JSON.parse(n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?new TextDecoder().decode(n.data):n.data);if(e.isVertexAI()){let e,t,n,r,o,a,s,u;Object.assign(i,(e={},null!=(t=tt(l,["setupComplete"]))&&te(e,["setupComplete"],t),null!=(n=tt(l,["serverContent"]))&&te(e,["serverContent"],n),null!=(r=tt(l,["toolCall"]))&&te(e,["toolCall"],r),null!=(o=tt(l,["toolCallCancellation"]))&&te(e,["toolCallCancellation"],o),null!=(a=tt(l,["usageMetadata"]))&&te(e,["usageMetadata"],function(e){let t={},n=tt(e,["promptTokenCount"]);null!=n&&te(t,["promptTokenCount"],n);let i=tt(e,["cachedContentTokenCount"]);null!=i&&te(t,["cachedContentTokenCount"],i);let l=tt(e,["candidatesTokenCount"]);null!=l&&te(t,["responseTokenCount"],l);let r=tt(e,["toolUsePromptTokenCount"]);null!=r&&te(t,["toolUsePromptTokenCount"],r);let o=tt(e,["thoughtsTokenCount"]);null!=o&&te(t,["thoughtsTokenCount"],o);let a=tt(e,["totalTokenCount"]);null!=a&&te(t,["totalTokenCount"],a);let s=tt(e,["promptTokensDetails"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["promptTokensDetails"],e)}let u=tt(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["cacheTokensDetails"],e)}let p=tt(e,["candidatesTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["responseTokensDetails"],e)}let d=tt(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["toolUsePromptTokensDetails"],e)}let c=tt(e,["trafficType"]);return null!=c&&te(t,["trafficType"],c),t}(a)),null!=(s=tt(l,["goAway"]))&&te(e,["goAway"],s),null!=(u=tt(l,["sessionResumptionUpdate"]))&&te(e,["sessionResumptionUpdate"],u),e))}else Object.assign(i,l);t(i)}class nV{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new nG(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,l,r,o,a,s;let u,p;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),h=this.apiClient.getHeaders();e.config&&e.config.tools&&nq(e.config.tools)&&nk(h);let m=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t}(h);if(this.apiClient.isVertexAI())u=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,u);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==c&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),u=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.${t}?${n}=${e}`}let f=()=>{},g=new Promise(e=>{f=e}),y=e.callbacks,E=this.apiClient,_={onopen:function(){var e;null==(e=null==y?void 0:y.onopen)||e.call(y),f({})},onmessage:e=>{nH(E,y.onmessage,e)},onerror:null!=(t=null==y?void 0:y.onerror)?t:function(e){},onclose:null!=(n=null==y?void 0:y.onclose)?n:function(e){}},v=this.webSocketFactory.create(u,(p={},m.forEach((e,t)=>{p[t]=e}),p),_);v.connect(),await g;let I=tM(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();I=`projects/${e}/locations/${t}/`+I}let T={};this.apiClient.isVertexAI()&&(null==(i=e.config)?void 0:i.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[eS.AUDIO]}:e.config.responseModalities=[eS.AUDIO]),(null==(l=e.config)?void 0:l.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let A=null!=(o=null==(r=e.config)?void 0:r.tools)?o:[],S=[];for(let e of A)this.isCallableTool(e)?S.push(await e.tool()):S.push(e);S.length>0&&(e.config.tools=S);let C={model:I,config:e.config,callbacks:e.callbacks};if(this.apiClient.isVertexAI()){let e,t,n;a=this.apiClient,e={},null!=(t=tt(C,["model"]))&&te(e,["setup","model"],tM(a,t)),null!=(n=tt(C,["config"]))&&te(e,["config"],function(e,t){let n=tt(e,["generationConfig"]);void 0!==t&&null!=n&&te(t,["setup","generationConfig"],function(e){let t={},n=tt(e,["modelSelectionConfig"]);null!=n&&te(t,["modelConfig"],n);let i=tt(e,["responseJsonSchema"]);null!=i&&te(t,["responseJsonSchema"],i);let l=tt(e,["audioTimestamp"]);null!=l&&te(t,["audioTimestamp"],l);let r=tt(e,["candidateCount"]);null!=r&&te(t,["candidateCount"],r);let o=tt(e,["enableAffectiveDialog"]);null!=o&&te(t,["enableAffectiveDialog"],o);let a=tt(e,["frequencyPenalty"]);null!=a&&te(t,["frequencyPenalty"],a);let s=tt(e,["logprobs"]);null!=s&&te(t,["logprobs"],s);let u=tt(e,["maxOutputTokens"]);null!=u&&te(t,["maxOutputTokens"],u);let p=tt(e,["mediaResolution"]);null!=p&&te(t,["mediaResolution"],p);let d=tt(e,["presencePenalty"]);null!=d&&te(t,["presencePenalty"],d);let c=tt(e,["responseLogprobs"]);null!=c&&te(t,["responseLogprobs"],c);let h=tt(e,["responseMimeType"]);null!=h&&te(t,["responseMimeType"],h);let m=tt(e,["responseModalities"]);null!=m&&te(t,["responseModalities"],m);let f=tt(e,["responseSchema"]);null!=f&&te(t,["responseSchema"],f);let g=tt(e,["routingConfig"]);null!=g&&te(t,["routingConfig"],g);let y=tt(e,["seed"]);null!=y&&te(t,["seed"],y);let E=tt(e,["speechConfig"]);null!=E&&te(t,["speechConfig"],nh(E));let _=tt(e,["stopSequences"]);null!=_&&te(t,["stopSequences"],_);let v=tt(e,["temperature"]);null!=v&&te(t,["temperature"],v);let I=tt(e,["thinkingConfig"]);null!=I&&te(t,["thinkingConfig"],I);let T=tt(e,["topK"]);null!=T&&te(t,["topK"],T);let A=tt(e,["topP"]);if(null!=A&&te(t,["topP"],A),void 0!==tt(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));let i=tt(e,["responseModalities"]);void 0!==t&&null!=i&&te(t,["setup","generationConfig","responseModalities"],i);let l=tt(e,["temperature"]);void 0!==t&&null!=l&&te(t,["setup","generationConfig","temperature"],l);let r=tt(e,["topP"]);void 0!==t&&null!=r&&te(t,["setup","generationConfig","topP"],r);let o=tt(e,["topK"]);void 0!==t&&null!=o&&te(t,["setup","generationConfig","topK"],o);let a=tt(e,["maxOutputTokens"]);void 0!==t&&null!=a&&te(t,["setup","generationConfig","maxOutputTokens"],a);let s=tt(e,["mediaResolution"]);void 0!==t&&null!=s&&te(t,["setup","generationConfig","mediaResolution"],s);let u=tt(e,["seed"]);void 0!==t&&null!=u&&te(t,["setup","generationConfig","seed"],u);let p=tt(e,["speechConfig"]);void 0!==t&&null!=p&&te(t,["setup","generationConfig","speechConfig"],nh(tK(p)));let d=tt(e,["thinkingConfig"]);void 0!==t&&null!=d&&te(t,["setup","generationConfig","thinkingConfig"],d);let c=tt(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&te(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=tt(e,["systemInstruction"]);void 0!==t&&null!=h&&te(t,["setup","systemInstruction"],tV(h));let m=tt(e,["tools"]);if(void 0!==t&&null!=m){let e=t$(m);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tt(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=tt(e,["description"]);null!=n&&te(t,["description"],n);let i=tt(e,["name"]);null!=i&&te(t,["name"],i);let l=tt(e,["parameters"]);null!=l&&te(t,["parameters"],l);let r=tt(e,["parametersJsonSchema"]);null!=r&&te(t,["parametersJsonSchema"],r);let o=tt(e,["response"]);null!=o&&te(t,["response"],o);let a=tt(e,["responseJsonSchema"]);return null!=a&&te(t,["responseJsonSchema"],a),t})(e))),te(t,["functionDeclarations"],e)}let i=tt(e,["retrieval"]);null!=i&&te(t,["retrieval"],i);let l=tt(e,["googleSearchRetrieval"]);null!=l&&te(t,["googleSearchRetrieval"],l);let r=tt(e,["computerUse"]);if(null!=r&&te(t,["computerUse"],r),void 0!==tt(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tt(e,["codeExecution"]);null!=o&&te(t,["codeExecution"],o);let a=tt(e,["enterpriseWebSearch"]);null!=a&&te(t,["enterpriseWebSearch"],a);let s=tt(e,["googleMaps"]);null!=s&&te(t,["googleMaps"],s);let u=tt(e,["googleSearch"]);null!=u&&te(t,["googleSearch"],u);let p=tt(e,["urlContext"]);return null!=p&&te(t,["urlContext"],p),t})(tW(e)))),te(t,["setup","tools"],e)}let f=tt(e,["sessionResumption"]);void 0!==t&&null!=f&&te(t,["setup","sessionResumption"],f);let g=tt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&te(t,["setup","inputAudioTranscription"],g);let y=tt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&te(t,["setup","outputAudioTranscription"],y);let E=tt(e,["realtimeInputConfig"]);void 0!==t&&null!=E&&te(t,["setup","realtimeInputConfig"],E);let _=tt(e,["contextWindowCompression"]);void 0!==t&&null!=_&&te(t,["setup","contextWindowCompression"],_);let v=tt(e,["proactivity"]);return void 0!==t&&null!=v&&te(t,["setup","proactivity"],v),{}}(n,e)),T=e}else{let e,t,n;s=this.apiClient,e={},null!=(t=tt(C,["model"]))&&te(e,["setup","model"],tM(s,t)),null!=(n=tt(C,["config"]))&&te(e,["config"],function(e,t){let n=tt(e,["generationConfig"]);void 0!==t&&null!=n&&te(t,["setup","generationConfig"],n);let i=tt(e,["responseModalities"]);void 0!==t&&null!=i&&te(t,["setup","generationConfig","responseModalities"],i);let l=tt(e,["temperature"]);void 0!==t&&null!=l&&te(t,["setup","generationConfig","temperature"],l);let r=tt(e,["topP"]);void 0!==t&&null!=r&&te(t,["setup","generationConfig","topP"],r);let o=tt(e,["topK"]);void 0!==t&&null!=o&&te(t,["setup","generationConfig","topK"],o);let a=tt(e,["maxOutputTokens"]);void 0!==t&&null!=a&&te(t,["setup","generationConfig","maxOutputTokens"],a);let s=tt(e,["mediaResolution"]);void 0!==t&&null!=s&&te(t,["setup","generationConfig","mediaResolution"],s);let u=tt(e,["seed"]);void 0!==t&&null!=u&&te(t,["setup","generationConfig","seed"],u);let p=tt(e,["speechConfig"]);void 0!==t&&null!=p&&te(t,["setup","generationConfig","speechConfig"],tK(p));let d=tt(e,["thinkingConfig"]);void 0!==t&&null!=d&&te(t,["setup","generationConfig","thinkingConfig"],d);let c=tt(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&te(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=tt(e,["systemInstruction"]);void 0!==t&&null!=h&&te(t,["setup","systemInstruction"],function(e){let t={},n=tt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a,s,u,p,d,c,h;return n={},null!=(i=tt(t=e,["mediaResolution"]))&&te(n,["mediaResolution"],i),null!=(l=tt(t,["codeExecutionResult"]))&&te(n,["codeExecutionResult"],l),null!=(r=tt(t,["executableCode"]))&&te(n,["executableCode"],r),null!=(o=tt(t,["fileData"]))&&te(n,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["fileUri"]);null!=n&&te(t,["fileUri"],n);let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(o)),null!=(a=tt(t,["functionCall"]))&&te(n,["functionCall"],function(e){let t={},n=tt(e,["id"]);null!=n&&te(t,["id"],n);let i=tt(e,["args"]);null!=i&&te(t,["args"],i);let l=tt(e,["name"]);if(null!=l&&te(t,["name"],l),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(a)),null!=(s=tt(t,["functionResponse"]))&&te(n,["functionResponse"],s),null!=(u=tt(t,["inlineData"]))&&te(n,["inlineData"],nc(u)),null!=(p=tt(t,["text"]))&&te(n,["text"],p),null!=(d=tt(t,["thought"]))&&te(n,["thought"],d),null!=(c=tt(t,["thoughtSignature"]))&&te(n,["thoughtSignature"],c),null!=(h=tt(t,["videoMetadata"]))&&te(n,["videoMetadata"],h),n})),te(t,["parts"],e)}let i=tt(e,["role"]);return null!=i&&te(t,["role"],i),t}(tV(h)));let m=tt(e,["tools"]);if(void 0!==t&&null!=m){let e=t$(m);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let l=tt(e,["computerUse"]);null!=l&&te(t,["computerUse"],l);let r=tt(e,["fileSearch"]);null!=r&&te(t,["fileSearch"],r);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tt(e,["enableWidget"]);return null!=n&&te(t,["enableWidget"],n),t}(a));let s=tt(e,["googleSearch"]);null!=s&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tt(e,["timeRangeFilter"]);return null!=n&&te(t,["timeRangeFilter"],n),t}(s));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tW(e)))),te(t,["setup","tools"],e)}let f=tt(e,["sessionResumption"]);void 0!==t&&null!=f&&te(t,["setup","sessionResumption"],function(e){let t={},n=tt(e,["handle"]);if(null!=n&&te(t,["handle"],n),void 0!==tt(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(f));let g=tt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&te(t,["setup","inputAudioTranscription"],g);let y=tt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&te(t,["setup","outputAudioTranscription"],y);let E=tt(e,["realtimeInputConfig"]);void 0!==t&&null!=E&&te(t,["setup","realtimeInputConfig"],E);let _=tt(e,["contextWindowCompression"]);void 0!==t&&null!=_&&te(t,["setup","contextWindowCompression"],_);let v=tt(e,["proactivity"]);return void 0!==t&&null!=v&&te(t,["setup","proactivity"],v),{}}(n,e)),T=e}return delete T.config,v.send(JSON.stringify(T)),new nB(v,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}let nj={turnComplete:!0};class nB{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=tB(t.turns),e.isVertexAI()||(n=n.map(e=>nm(e)))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses||0===(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},nj),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},n=tt(e,["media"]);if(null!=n){let e=tD(n);Array.isArray(e)&&(e=e.map(e=>e)),te(t,["mediaChunks"],e)}let i=tt(e,["audio"]);null!=i&&te(t,["audio"],tk(i));let l=tt(e,["audioStreamEnd"]);null!=l&&te(t,["audioStreamEnd"],l);let r=tt(e,["video"]);null!=r&&te(t,["video"],tq(r));let o=tt(e,["text"]);null!=o&&te(t,["text"],o);let a=tt(e,["activityStart"]);null!=a&&te(t,["activityStart"],a);let s=tt(e,["activityEnd"]);return null!=s&&te(t,["activityEnd"],s),t}(e)}:{realtimeInput:function(e){let t={},n=tt(e,["media"]);if(null!=n){let e=tD(n);Array.isArray(e)&&(e=e.map(e=>nc(e))),te(t,["mediaChunks"],e)}let i=tt(e,["audio"]);null!=i&&te(t,["audio"],nc(tk(i)));let l=tt(e,["audioStreamEnd"]);null!=l&&te(t,["audioStreamEnd"],l);let r=tt(e,["video"]);null!=r&&te(t,["video"],nc(tq(r)));let o=tt(e,["text"]);null!=o&&te(t,["text"],o);let a=tt(e,["activityStart"]);null!=a&&te(t,["activityStart"],a);let s=tt(e,["activityEnd"]);return null!=s&&te(t,["activityEnd"],s),t}(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function nJ(e){var t,n,i;if(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.disable)return!0;let l=!1;for(let t of null!=(n=null==e?void 0:e.tools)?n:[])if(nY(t)){l=!0;break}if(!l)return!0;let r=null==(i=null==e?void 0:e.automaticFunctionCalling)?void 0:i.maximumRemoteCalls;return(!(!r||!(r<0)&&Number.isInteger(r))||0==r)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0)}function nY(e){return"callTool"in e&&"function"==typeof e.callTool}function nK(e){var t;let n=[];return(null==(t=null==e?void 0:e.config)?void 0:t.tools)&&e.config.tools.forEach((e,t)=>{nY(e)||e.functionDeclarations&&e.functionDeclarations.length>0&&n.push(t)}),n}function nW(e){var t;return!(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.ignoreCallHistory)}class n$ extends e7{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,i,l,r,o,a,s;let u,p,d=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!(null!=(s=null==(a=null==(o=e.config)?void 0:o.tools)?void 0:a.some(e=>nY(e)))&&s)||nJ(e.config))return await this.generateContentInternal(d);let c=nK(e);if(c.length>0){let e=c.map(e=>`tools[${e}]`).join(", ");throw Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`)}let h=tB(d.contents),m=null!=(i=null==(n=null==(t=d.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?i:10,f=0;for(;f<m&&(u=await this.generateContentInternal(d)).functionCalls&&0!==u.functionCalls.length;){let t=u.candidates[0].content,n=[];for(let t of null!=(r=null==(l=e.config)?void 0:l.tools)?r:[])if(nY(t)){let e=await t.callTool(u.functionCalls);n.push(...e)}f++,p={role:"user",parts:n},d.contents=tB(d.contents),d.contents.push(t),d.contents.push(p),nW(d.config)&&(h.push(t),h.push(p))}return nW(d.config)&&(u.automaticFunctionCallingHistory=h),u},this.generateContentStream=async e=>{var t,n,i,l,r;if(this.maybeMoveToResponseJsonSchem(e),nJ(e.config)){let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}let o=nK(e);if(o.length>0){let e=o.map(e=>`tools[${e}]`).join(", ");throw Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let a=null==(i=null==(n=null==(t=null==e?void 0:e.config)?void 0:t.toolConfig)?void 0:n.functionCallingConfig)?void 0:i.streamFunctionCallArguments,s=null==(r=null==(l=null==e?void 0:e.config)?void 0:l.automaticFunctionCalling)?void 0:r.disable;if(a&&!s)throw Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n,i=[];if(null==e?void 0:e.generatedImages)for(let l of e.generatedImages)l&&(null==l?void 0:l.safetyAttributes)&&(null==(t=null==l?void 0:l.safetyAttributes)?void 0:t.contentType)==="Positive Prompt"?n=null==l?void 0:l.safetyAttributes:i.push(l);return n?{generatedImages:i,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:i,sdkHttpResponse:e.sdkHttpResponse}}),this.list=async e=>{var t;let n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase)if(null==(t=n.config)?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else n.config.filter="labels.tune-type:*";return new t9(e6.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,i,l,r,o;if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null==(t=e.video)?void 0:t.uri)&&(null==(n=e.video)?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null==(l=null==(i=e.source)?void 0:i.video)?void 0:l.uri)&&(null==(o=null==(r=e.source)?void 0:r.video)?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema)}async processParamsMaybeAddMcpUsage(e){var t,n,i;let l=null==(t=e.config)?void 0:t.tools;if(!l)return e;let r=await Promise.all(l.map(async e=>nY(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:r})};if(o.config.tools=r,e.config&&e.config.tools&&nq(e.config.tools)){let t=Object.assign({},null!=(i=null==(n=e.config.httpOptions)?void 0:n.headers)?i:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),nk(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t})}return o}async initAfcToolsMap(e){var t,n,i;let l=new Map;for(let r of null!=(n=null==(t=e.config)?void 0:t.tools)?n:[])if(nY(r))for(let e of null!=(i=(await r.tool()).functionDeclarations)?i:[]){if(!e.name)throw Error("Function declaration name is required.");if(l.has(e.name))throw Error(`Duplicate tool declaration name: ${e.name}`);l.set(e.name,r)}return l}async processAfcStream(e){var t,n,i;let l=null!=(i=null==(n=null==(t=e.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?i:10,r=!1,o=0;return function(e,t,n){var i,a;return nl(this,arguments,function*(){for(var s,u,p,d;o<l;){r&&(o++,r=!1);let f=yield ni(e.processParamsMaybeAddMcpUsage(n)),g=yield ni(e.generateContentStreamInternal(f)),y=[],E=[];try{for(var c,h=!0,m=(u=void 0,nr(g));!(s=(c=yield ni(m.next())).done);h=!0)if(d=c.value,h=!1,yield yield ni(d),d.candidates&&(null==(i=d.candidates[0])?void 0:i.content)){for(let e of(E.push(d.candidates[0].content),null!=(a=d.candidates[0].content.parts)?a:[]))if(o<l&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let n=yield ni(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...n)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`)}}}catch(e){u={error:e}}finally{try{!h&&!s&&(p=m.return)&&(yield ni(p.call(m)))}finally{if(u)throw u.error}}if(y.length>0){r=!0;let e=new tr;e.candidates=[{content:{role:"user",parts:y}}],yield yield ni(e);let t=[];t.push(...E),t.push({role:"user",parts:y});let i=tB(n.contents).concat(t);n.contents=i}else break}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=ng(this.apiClient,e);return r=e9("{model}:generateContent",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=nE(e),n=new tr;return Object.assign(n,t),n})}{let t=nf(this.apiClient,e);return r=e9("{model}:generateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=ny(e),n=new tr;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=ng(this.apiClient,e);return r=e9("{model}:streamGenerateContent?alt=sse",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.requestStream({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(function(e){return nl(this,arguments,function*(){var t,n,i,l;try{for(var r,o=!0,a=nr(e);!(t=(r=yield ni(a.next())).done);o=!0){l=r.value,o=!1;let e=nE((yield ni(l.json())));e.sdkHttpResponse={headers:l.headers};let t=new tr;Object.assign(t,e),yield yield ni(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(i=a.return)&&(yield ni(i.call(a)))}finally{if(n)throw n.error}}})})}{let t=nf(this.apiClient,e);return r=e9("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.requestStream({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(function(e){return nl(this,arguments,function*(){var t,n,i,l;try{for(var r,o=!0,a=nr(e);!(t=(r=yield ni(a.next())).done);o=!0){l=r.value,o=!1;let e=ny((yield ni(l.json())));e.sdkHttpResponse={headers:l.headers};let t=new tr;Object.assign(t,e),yield yield ni(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(i=a.return)&&(yield ni(i.call(a)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n,i,l,r,o,a={},s=tt(t,["model"]);null!=s&&te(a,["_url","model"],tM(e,s));let u=tt(t,["contents"]);if(null!=u){let t=tj(e,u);Array.isArray(t)&&(t=t.map(e=>e)),te(a,["instances[]","content"],t)}let p=tt(t,["config"]);return null!=p&&(n=tt(p,["taskType"]),void 0!==a&&null!=n&&te(a,["instances[]","task_type"],n),i=tt(p,["title"]),void 0!==a&&null!=i&&te(a,["instances[]","title"],i),l=tt(p,["outputDimensionality"]),void 0!==a&&null!=l&&te(a,["parameters","outputDimensionality"],l),r=tt(p,["mimeType"]),void 0!==a&&null!=r&&te(a,["instances[]","mimeType"],r),o=tt(p,["autoTruncate"]),void 0!==a&&null!=o&&te(a,["parameters","autoTruncate"],o)),a}(this.apiClient,e);return r=e9("{model}:predict",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["predictions[]","embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a;return n={},null!=(i=tt(e,["values"]))&&te(n,["values"],i),null!=(l=tt(e,["statistics"]))&&te(n,["statistics"],(r={},null!=(o=tt(t=l,["truncated"]))&&te(r,["truncated"],o),null!=(a=tt(t,["token_count"]))&&te(r,["tokenCount"],a),r)),n})),te(t,["embeddings"],e)}let l=tt(e,["metadata"]);return null!=l&&te(t,["metadata"],l),t}(e),n=new to;return Object.assign(n,t),n})}{let t=function(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["_url","model"],tM(e,i));let l=tt(t,["contents"]);if(null!=l){let t=tj(e,l);Array.isArray(t)&&(t=t.map(e=>e)),te(n,["requests[]","content"],t)}let r=tt(t,["config"]);null!=r&&function(e,t){let n=tt(e,["taskType"]);void 0!==t&&null!=n&&te(t,["requests[]","taskType"],n);let i=tt(e,["title"]);void 0!==t&&null!=i&&te(t,["requests[]","title"],i);let l=tt(e,["outputDimensionality"]);if(void 0!==t&&null!=l&&te(t,["requests[]","outputDimensionality"],l),void 0!==tt(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==tt(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(r,n);let o=tt(t,["model"]);return void 0!==o&&te(n,["requests[]","model"],tM(e,o)),n}(this.apiClient,e);return r=e9("{model}:batchEmbedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["embeddings"],e)}let l=tt(e,["metadata"]);return null!=l&&te(t,["metadata"],l),t}(e),n=new to;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d,c,h,m,f,g,y,E,_,v,I,T,A,S,C,O,b=(r=this.apiClient,i={},null!=(l=tt(e,["model"]))&&te(i,["_url","model"],tM(r,l)),null!=(o=tt(e,["prompt"]))&&te(i,["instances[0]","prompt"],o),null!=(u=tt(e,["config"]))&&(p=tt(u,["outputGcsUri"]),void 0!==i&&null!=p&&te(i,["parameters","storageUri"],p),d=tt(u,["negativePrompt"]),void 0!==i&&null!=d&&te(i,["parameters","negativePrompt"],d),c=tt(u,["numberOfImages"]),void 0!==i&&null!=c&&te(i,["parameters","sampleCount"],c),h=tt(u,["aspectRatio"]),void 0!==i&&null!=h&&te(i,["parameters","aspectRatio"],h),m=tt(u,["guidanceScale"]),void 0!==i&&null!=m&&te(i,["parameters","guidanceScale"],m),f=tt(u,["seed"]),void 0!==i&&null!=f&&te(i,["parameters","seed"],f),g=tt(u,["safetyFilterLevel"]),void 0!==i&&null!=g&&te(i,["parameters","safetySetting"],g),y=tt(u,["personGeneration"]),void 0!==i&&null!=y&&te(i,["parameters","personGeneration"],y),E=tt(u,["includeSafetyAttributes"]),void 0!==i&&null!=E&&te(i,["parameters","includeSafetyAttributes"],E),_=tt(u,["includeRaiReason"]),void 0!==i&&null!=_&&te(i,["parameters","includeRaiReason"],_),v=tt(u,["language"]),void 0!==i&&null!=v&&te(i,["parameters","language"],v),I=tt(u,["outputMimeType"]),void 0!==i&&null!=I&&te(i,["parameters","outputOptions","mimeType"],I),T=tt(u,["outputCompressionQuality"]),void 0!==i&&null!=T&&te(i,["parameters","outputOptions","compressionQuality"],T),A=tt(u,["addWatermark"]),void 0!==i&&null!=A&&te(i,["parameters","addWatermark"],A),S=tt(u,["labels"]),void 0!==i&&null!=S&&te(i,["labels"],S),C=tt(u,["imageSize"]),void 0!==i&&null!=C&&te(i,["parameters","sampleImageSize"],C),O=tt(u,["enhancePrompt"]),void 0!==i&&null!=O&&te(i,["parameters","enhancePrompt"],O)),i);return a=e9("{model}:predict",b._url),s=b._query,delete b._url,delete b._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>n_(e))),te(t,["generatedImages"],e)}let l=tt(e,["positivePromptSafetyAttributes"]);return null!=l&&te(t,["positivePromptSafetyAttributes"],nO(l)),t}(e),n=new ta;return Object.assign(n,t),n})}{let t,n,r,u,p=(o=this.apiClient,t={},null!=(n=tt(e,["model"]))&&te(t,["_url","model"],tM(o,n)),null!=(r=tt(e,["prompt"]))&&te(t,["instances[0]","prompt"],r),null!=(u=tt(e,["config"]))&&function(e,t){if(void 0!==tt(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==tt(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let n=tt(e,["numberOfImages"]);void 0!==t&&null!=n&&te(t,["parameters","sampleCount"],n);let i=tt(e,["aspectRatio"]);void 0!==t&&null!=i&&te(t,["parameters","aspectRatio"],i);let l=tt(e,["guidanceScale"]);if(void 0!==t&&null!=l&&te(t,["parameters","guidanceScale"],l),void 0!==tt(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let r=tt(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&te(t,["parameters","safetySetting"],r);let o=tt(e,["personGeneration"]);void 0!==t&&null!=o&&te(t,["parameters","personGeneration"],o);let a=tt(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&te(t,["parameters","includeSafetyAttributes"],a);let s=tt(e,["includeRaiReason"]);void 0!==t&&null!=s&&te(t,["parameters","includeRaiReason"],s);let u=tt(e,["language"]);void 0!==t&&null!=u&&te(t,["parameters","language"],u);let p=tt(e,["outputMimeType"]);void 0!==t&&null!=p&&te(t,["parameters","outputOptions","mimeType"],p);let d=tt(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&te(t,["parameters","outputOptions","compressionQuality"],d),void 0!==tt(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==tt(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let c=tt(e,["imageSize"]);if(void 0!==t&&null!=c&&te(t,["parameters","sampleImageSize"],c),void 0!==tt(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(u,t),t);return a=e9("{model}:predict",p._url),s=p._query,delete p._url,delete p._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t,n;let i,l,r,o,a,s,u;return i={},null!=(l=tt(t=e,["_self"]))&&te(i,["image"],(r={},null!=(o=tt(n=l,["bytesBase64Encoded"]))&&te(r,["imageBytes"],tn(o)),null!=(a=tt(n,["mimeType"]))&&te(r,["mimeType"],a),r)),null!=(s=tt(t,["raiFilteredReason"]))&&te(i,["raiFilteredReason"],s),null!=(u=tt(t,["_self"]))&&te(i,["safetyAttributes"],nC(u)),i})),te(t,["generatedImages"],e)}let l=tt(e,["positivePromptSafetyAttributes"]);return null!=l&&te(t,["positivePromptSafetyAttributes"],nC(l)),t}(e),n=new ta;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n,i,l,r,o,a,s,u,p,d,c,h,m,f,g,y,E,_={},v=tt(t,["model"]);null!=v&&te(_,["_url","model"],tM(e,v));let I=tt(t,["prompt"]);null!=I&&te(_,["instances[0]","prompt"],I);let T=tt(t,["referenceImages"]);if(null!=T){let e=T;Array.isArray(e)&&(e=e.map(e=>(function(e){let t,n,i,l,r,o,a,s={},u=tt(e,["referenceImage"]);null!=u&&te(s,["referenceImage"],nT(u));let p=tt(e,["referenceId"]);null!=p&&te(s,["referenceId"],p);let d=tt(e,["referenceType"]);null!=d&&te(s,["referenceType"],d);let c=tt(e,["maskImageConfig"]);null!=c&&te(s,["maskImageConfig"],(t={},null!=(n=tt(c,["maskMode"]))&&te(t,["maskMode"],n),null!=(i=tt(c,["segmentationClasses"]))&&te(t,["maskClasses"],i),null!=(l=tt(c,["maskDilation"]))&&te(t,["dilation"],l),t));let h=tt(e,["controlImageConfig"]);null!=h&&te(s,["controlImageConfig"],(r={},null!=(o=tt(h,["controlType"]))&&te(r,["controlType"],o),null!=(a=tt(h,["enableControlImageComputation"]))&&te(r,["computeControl"],a),r));let m=tt(e,["styleImageConfig"]);null!=m&&te(s,["styleImageConfig"],m);let f=tt(e,["subjectImageConfig"]);return null!=f&&te(s,["subjectImageConfig"],f),s})(e))),te(_,["instances[0]","referenceImages"],e)}let A=tt(t,["config"]);return null!=A&&(n=tt(A,["outputGcsUri"]),void 0!==_&&null!=n&&te(_,["parameters","storageUri"],n),i=tt(A,["negativePrompt"]),void 0!==_&&null!=i&&te(_,["parameters","negativePrompt"],i),l=tt(A,["numberOfImages"]),void 0!==_&&null!=l&&te(_,["parameters","sampleCount"],l),r=tt(A,["aspectRatio"]),void 0!==_&&null!=r&&te(_,["parameters","aspectRatio"],r),o=tt(A,["guidanceScale"]),void 0!==_&&null!=o&&te(_,["parameters","guidanceScale"],o),a=tt(A,["seed"]),void 0!==_&&null!=a&&te(_,["parameters","seed"],a),s=tt(A,["safetyFilterLevel"]),void 0!==_&&null!=s&&te(_,["parameters","safetySetting"],s),u=tt(A,["personGeneration"]),void 0!==_&&null!=u&&te(_,["parameters","personGeneration"],u),p=tt(A,["includeSafetyAttributes"]),void 0!==_&&null!=p&&te(_,["parameters","includeSafetyAttributes"],p),d=tt(A,["includeRaiReason"]),void 0!==_&&null!=d&&te(_,["parameters","includeRaiReason"],d),c=tt(A,["language"]),void 0!==_&&null!=c&&te(_,["parameters","language"],c),h=tt(A,["outputMimeType"]),void 0!==_&&null!=h&&te(_,["parameters","outputOptions","mimeType"],h),m=tt(A,["outputCompressionQuality"]),void 0!==_&&null!=m&&te(_,["parameters","outputOptions","compressionQuality"],m),f=tt(A,["addWatermark"]),void 0!==_&&null!=f&&te(_,["parameters","addWatermark"],f),g=tt(A,["labels"]),void 0!==_&&null!=g&&te(_,["labels"],g),y=tt(A,["editMode"]),void 0!==_&&null!=y&&te(_,["parameters","editMode"],y),E=tt(A,["baseSteps"]),void 0!==_&&null!=E&&te(_,["parameters","editConfig","baseSteps"],E)),_}(this.apiClient,e);return i=e9("{model}:predict",r._url),l=r._query,delete r._url,delete r._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>n_(e))),te(t,["generatedImages"],e)}return t}(e),n=new ts;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n,i;let l="",r={};if(this.apiClient.isVertexAI()){let o,a,s,u,p,d,c,h,m,f,g,y,E,_,v,I,T=(i=this.apiClient,o={},null!=(a=tt(e,["model"]))&&te(o,["_url","model"],tM(i,a)),null!=(s=tt(e,["image"]))&&te(o,["instances[0]","image"],nT(s)),null!=(u=tt(e,["upscaleFactor"]))&&te(o,["parameters","upscaleConfig","upscaleFactor"],u),null!=(p=tt(e,["config"]))&&(d=tt(p,["outputGcsUri"]),void 0!==o&&null!=d&&te(o,["parameters","storageUri"],d),c=tt(p,["safetyFilterLevel"]),void 0!==o&&null!=c&&te(o,["parameters","safetySetting"],c),h=tt(p,["personGeneration"]),void 0!==o&&null!=h&&te(o,["parameters","personGeneration"],h),m=tt(p,["includeRaiReason"]),void 0!==o&&null!=m&&te(o,["parameters","includeRaiReason"],m),f=tt(p,["outputMimeType"]),void 0!==o&&null!=f&&te(o,["parameters","outputOptions","mimeType"],f),g=tt(p,["outputCompressionQuality"]),void 0!==o&&null!=g&&te(o,["parameters","outputOptions","compressionQuality"],g),y=tt(p,["enhanceInputImage"]),void 0!==o&&null!=y&&te(o,["parameters","upscaleConfig","enhanceInputImage"],y),E=tt(p,["imagePreservationFactor"]),void 0!==o&&null!=E&&te(o,["parameters","upscaleConfig","imagePreservationFactor"],E),_=tt(p,["labels"]),void 0!==o&&null!=_&&te(o,["labels"],_),v=tt(p,["numberOfImages"]),void 0!==o&&null!=v&&te(o,["parameters","sampleCount"],v),I=tt(p,["mode"]),void 0!==o&&null!=I&&te(o,["parameters","mode"],I)),o);return l=e9("{model}:predict",T._url),r=T._query,delete T._url,delete T._query,this.apiClient.request({path:l,queryParams:r,body:JSON.stringify(T),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>n_(e))),te(t,["generatedImages"],e)}return t}(e),n=new tu;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n,i;let l="",r={};if(this.apiClient.isVertexAI()){let o,a,s,u,p,d,c,h,m,f,g,y,E,_,v,I=(i=this.apiClient,o={},null!=(a=tt(e,["model"]))&&te(o,["_url","model"],tM(i,a)),null!=(s=tt(e,["source"]))&&function(e,t){let n=tt(e,["prompt"]);void 0!==t&&null!=n&&te(t,["instances[0]","prompt"],n);let i=tt(e,["personImage"]);void 0!==t&&null!=i&&te(t,["instances[0]","personImage","image"],nT(i));let l=tt(e,["productImages"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>{let t,n;return t={},null!=(n=tt(e,["productImage"]))&&te(t,["image"],nT(n)),t})),te(t,["instances[0]","productImages"],e)}}(s,o),null!=(u=tt(e,["config"]))&&(p=tt(u,["numberOfImages"]),void 0!==o&&null!=p&&te(o,["parameters","sampleCount"],p),d=tt(u,["baseSteps"]),void 0!==o&&null!=d&&te(o,["parameters","baseSteps"],d),c=tt(u,["outputGcsUri"]),void 0!==o&&null!=c&&te(o,["parameters","storageUri"],c),h=tt(u,["seed"]),void 0!==o&&null!=h&&te(o,["parameters","seed"],h),m=tt(u,["safetyFilterLevel"]),void 0!==o&&null!=m&&te(o,["parameters","safetySetting"],m),f=tt(u,["personGeneration"]),void 0!==o&&null!=f&&te(o,["parameters","personGeneration"],f),g=tt(u,["addWatermark"]),void 0!==o&&null!=g&&te(o,["parameters","addWatermark"],g),y=tt(u,["outputMimeType"]),void 0!==o&&null!=y&&te(o,["parameters","outputOptions","mimeType"],y),E=tt(u,["outputCompressionQuality"]),void 0!==o&&null!=E&&te(o,["parameters","outputOptions","compressionQuality"],E),_=tt(u,["enhancePrompt"]),void 0!==o&&null!=_&&te(o,["parameters","enhancePrompt"],_),v=tt(u,["labels"]),void 0!==o&&null!=v&&te(o,["labels"],v)),o);return l=e9("{model}:predict",I._url),r=I._query,delete I._url,delete I._query,this.apiClient.request({path:l,queryParams:r,body:JSON.stringify(I),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>n_(e))),te(t,["generatedImages"],e)}return t}(e),n=new tp;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n,i,l,r;let o="",a={};if(this.apiClient.isVertexAI()){let s,u,p,d,c,h,m,f,g,y,E,_,v,I,T,A=(i=this.apiClient,h={},null!=(m=tt(e,["model"]))&&te(h,["_url","model"],tM(i,m)),null!=(f=tt(e,["source"]))&&(l=f,r=h,p=tt(l,["prompt"]),void 0!==r&&null!=p&&te(r,["instances[0]","prompt"],p),d=tt(l,["image"]),void 0!==r&&null!=d&&te(r,["instances[0]","image"],nT(d)),c=tt(l,["scribbleImage"]),void 0!==r&&null!=c&&te(r,["instances[0]","scribble"],(s={},null!=(u=tt(c,["image"]))&&te(s,["image"],nT(u)),s))),null!=(g=tt(e,["config"]))&&(y=tt(g,["mode"]),void 0!==h&&null!=y&&te(h,["parameters","mode"],y),E=tt(g,["maxPredictions"]),void 0!==h&&null!=E&&te(h,["parameters","maxPredictions"],E),_=tt(g,["confidenceThreshold"]),void 0!==h&&null!=_&&te(h,["parameters","confidenceThreshold"],_),v=tt(g,["maskDilation"]),void 0!==h&&null!=v&&te(h,["parameters","maskDilation"],v),I=tt(g,["binaryColorThreshold"]),void 0!==h&&null!=I&&te(h,["parameters","binaryColorThreshold"],I),T=tt(g,["labels"]),void 0!==h&&null!=T&&te(h,["labels"],T)),h);return o=e9("{model}:predict",A._url),a=A._query,delete A._url,delete A._query,this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(A),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tt(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["_self"]);null!=n&&te(t,["mask"],nv(n));let i=tt(e,["labels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["labels"],e)}return t})(e))),te(t,["generatedMasks"],e)}return t}(e),n=new td;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tt(e,["model"]))&&te(i,["_url","name"],tM(r,l)),i);return a=e9("{name}",o._url),s=o._query,delete o._url,delete o._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nS(e))}{let t,n,r=(o=this.apiClient,t={},null!=(n=tt(e,["model"]))&&te(t,["_url","name"],tM(o,n)),t);return a=e9("{name}",r._url),s=r._query,delete r._url,delete r._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>nA(e))}}async listInternal(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d,c=(r=this.apiClient,i={},null!=(l=tt(e,["config"]))&&(o=tt(l,["pageSize"]),void 0!==i&&null!=o&&te(i,["_query","pageSize"],o),u=tt(l,["pageToken"]),void 0!==i&&null!=u&&te(i,["_query","pageToken"],u),p=tt(l,["filter"]),void 0!==i&&null!=p&&te(i,["_query","filter"],p),d=tt(l,["queryBase"]),void 0!==i&&null!=d&&te(i,["_url","models_url"],tZ(r,d))),i);return a=e9("{models_url}",c._url),s=c._query,delete c._url,delete c._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(c),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["_self"]);if(null!=l){let e=t0(l);Array.isArray(e)&&(e=e.map(e=>nS(e))),te(t,["models"],e)}return t}(e),n=new tc;return Object.assign(n,t),n})}{let t,n,r,u,p,d,c=(o=this.apiClient,t={},null!=(n=tt(e,["config"]))&&(r=tt(n,["pageSize"]),void 0!==t&&null!=r&&te(t,["_query","pageSize"],r),u=tt(n,["pageToken"]),void 0!==t&&null!=u&&te(t,["_query","pageToken"],u),p=tt(n,["filter"]),void 0!==t&&null!=p&&te(t,["_query","filter"],p),d=tt(n,["queryBase"]),void 0!==t&&null!=d&&te(t,["_url","models_url"],tZ(o,d))),t);return a=e9("{models_url}",c._url),s=c._query,delete c._url,delete c._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(c),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["_self"]);if(null!=l){let e=t0(l);Array.isArray(e)&&(e=e.map(e=>nA(e))),te(t,["models"],e)}return t}(e),n=new tc;return Object.assign(n,t),n})}}async update(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d,c=(r=this.apiClient,i={},null!=(l=tt(e,["model"]))&&te(i,["_url","model"],tM(r,l)),null!=(o=tt(e,["config"]))&&(u=tt(o,["displayName"]),void 0!==i&&null!=u&&te(i,["displayName"],u),p=tt(o,["description"]),void 0!==i&&null!=p&&te(i,["description"],p),d=tt(o,["defaultCheckpointId"]),void 0!==i&&null!=d&&te(i,["defaultCheckpointId"],d)),i);return a=e9("{model}",c._url),s=c._query,delete c._url,delete c._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nS(e))}{let t,n,r,u,p,d,c=(o=this.apiClient,t={},null!=(n=tt(e,["model"]))&&te(t,["_url","name"],tM(o,n)),null!=(r=tt(e,["config"]))&&(u=tt(r,["displayName"]),void 0!==t&&null!=u&&te(t,["displayName"],u),p=tt(r,["description"]),void 0!==t&&null!=p&&te(t,["description"],p),d=tt(r,["defaultCheckpointId"]),void 0!==t&&null!=d&&te(t,["defaultCheckpointId"],d)),t);return a=e9("{name}",c._url),s=c._query,delete c._url,delete c._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>nA(e))}}async delete(e){var t,n,i,l,r,o;let a="",s={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tt(e,["model"]))&&te(i,["_url","name"],tM(r,l)),i);return a=e9("{name}",o._url),s=o._query,delete o._url,delete o._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),t),l=new th;return Object.assign(l,i),l})}{let t,n,r=(o=this.apiClient,t={},null!=(n=tt(e,["model"]))&&te(t,["_url","name"],tM(o,n)),t);return a=e9("{name}",r._url),s=r._query,delete r._url,delete r._query,this.apiClient.request({path:a,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),t),l=new th;return Object.assign(l,i),l})}}async countTokens(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["_url","model"],tM(e,i));let l=tt(t,["contents"]);if(null!=l){let e=tB(l);Array.isArray(e)&&(e=e.map(e=>e)),te(n,["contents"],e)}let r=tt(t,["config"]);return null!=r&&function(e,t){let n=tt(e,["systemInstruction"]);void 0!==t&&null!=n&&te(t,["systemInstruction"],tV(n));let i=tt(e,["tools"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nN(e))),te(t,["tools"],e)}let l=tt(e,["generationConfig"]);void 0!==t&&null!=l&&te(t,["generationConfig"],function(e){let t={},n=tt(e,["modelSelectionConfig"]);null!=n&&te(t,["modelConfig"],n);let i=tt(e,["responseJsonSchema"]);null!=i&&te(t,["responseJsonSchema"],i);let l=tt(e,["audioTimestamp"]);null!=l&&te(t,["audioTimestamp"],l);let r=tt(e,["candidateCount"]);null!=r&&te(t,["candidateCount"],r);let o=tt(e,["enableAffectiveDialog"]);null!=o&&te(t,["enableAffectiveDialog"],o);let a=tt(e,["frequencyPenalty"]);null!=a&&te(t,["frequencyPenalty"],a);let s=tt(e,["logprobs"]);null!=s&&te(t,["logprobs"],s);let u=tt(e,["maxOutputTokens"]);null!=u&&te(t,["maxOutputTokens"],u);let p=tt(e,["mediaResolution"]);null!=p&&te(t,["mediaResolution"],p);let d=tt(e,["presencePenalty"]);null!=d&&te(t,["presencePenalty"],d);let c=tt(e,["responseLogprobs"]);null!=c&&te(t,["responseLogprobs"],c);let h=tt(e,["responseMimeType"]);null!=h&&te(t,["responseMimeType"],h);let m=tt(e,["responseModalities"]);null!=m&&te(t,["responseModalities"],m);let f=tt(e,["responseSchema"]);null!=f&&te(t,["responseSchema"],f);let g=tt(e,["routingConfig"]);null!=g&&te(t,["routingConfig"],g);let y=tt(e,["seed"]);null!=y&&te(t,["seed"],y);let E=tt(e,["speechConfig"]);null!=E&&te(t,["speechConfig"],nb(E));let _=tt(e,["stopSequences"]);null!=_&&te(t,["stopSequences"],_);let v=tt(e,["temperature"]);null!=v&&te(t,["temperature"],v);let I=tt(e,["thinkingConfig"]);null!=I&&te(t,["thinkingConfig"],I);let T=tt(e,["topK"]);null!=T&&te(t,["topK"],T);let A=tt(e,["topP"]);if(null!=A&&te(t,["topP"],A),void 0!==tt(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(l))}(r,n),n}(this.apiClient,e);return r=e9("{model}:countTokens",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),null!=(i=tt(e,["totalTokens"]))&&te(t,["totalTokens"],i),t),r=new tm;return Object.assign(r,l),r})}{let t=function(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["_url","model"],tM(e,i));let l=tt(t,["contents"]);if(null!=l){let e=tB(l);Array.isArray(e)&&(e=e.map(e=>nm(e))),te(n,["contents"],e)}let r=tt(t,["config"]);return null!=r&&function(e){if(void 0!==tt(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==tt(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==tt(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(r),n}(this.apiClient,e);return r=e9("{model}:countTokens",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),null!=(i=tt(e,["totalTokens"]))&&te(t,["totalTokens"],i),null!=(l=tt(e,["cachedContentTokenCount"]))&&te(t,["cachedContentTokenCount"],l),t),o=new tm;return Object.assign(o,r),o})}}async computeTokens(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},i=tt(t,["model"]);null!=i&&te(n,["_url","model"],tM(e,i));let l=tt(t,["contents"]);if(null!=l){let e=tB(l);Array.isArray(e)&&(e=e.map(e=>e)),te(n,["contents"],e)}return n}(this.apiClient,e);return i=e9("{model}:computeTokens",r._url),l=r._query,delete r._url,delete r._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["tokensInfo"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["tokensInfo"],e)}return t}(e),n=new tf;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,i,l,r,o,a,s,u,p;let d="",c={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,h,m,f,g,y,E=(r=this.apiClient,u={},null!=(p=tt(e,["model"]))&&te(u,["_url","model"],tM(r,p)),null!=(h=tt(e,["prompt"]))&&te(u,["instances[0]","prompt"],h),null!=(m=tt(e,["image"]))&&te(u,["instances[0]","image"],nT(m)),null!=(f=tt(e,["video"]))&&te(u,["instances[0]","video"],nP(f)),null!=(g=tt(e,["source"]))&&(a=g,s=u,i=tt(a,["prompt"]),void 0!==s&&null!=i&&te(s,["instances[0]","prompt"],i),l=tt(a,["image"]),void 0!==s&&null!=l&&te(s,["instances[0]","image"],nT(l)),o=tt(a,["video"]),void 0!==s&&null!=o&&te(s,["instances[0]","video"],nP(o))),null!=(y=tt(e,["config"]))&&function(e,t){var n;let i,l,r,o=tt(e,["numberOfVideos"]);void 0!==t&&null!=o&&te(t,["parameters","sampleCount"],o);let a=tt(e,["outputGcsUri"]);void 0!==t&&null!=a&&te(t,["parameters","storageUri"],a);let s=tt(e,["fps"]);void 0!==t&&null!=s&&te(t,["parameters","fps"],s);let u=tt(e,["durationSeconds"]);void 0!==t&&null!=u&&te(t,["parameters","durationSeconds"],u);let p=tt(e,["seed"]);void 0!==t&&null!=p&&te(t,["parameters","seed"],p);let d=tt(e,["aspectRatio"]);void 0!==t&&null!=d&&te(t,["parameters","aspectRatio"],d);let c=tt(e,["resolution"]);void 0!==t&&null!=c&&te(t,["parameters","resolution"],c);let h=tt(e,["personGeneration"]);void 0!==t&&null!=h&&te(t,["parameters","personGeneration"],h);let m=tt(e,["pubsubTopic"]);void 0!==t&&null!=m&&te(t,["parameters","pubsubTopic"],m);let f=tt(e,["negativePrompt"]);void 0!==t&&null!=f&&te(t,["parameters","negativePrompt"],f);let g=tt(e,["enhancePrompt"]);void 0!==t&&null!=g&&te(t,["parameters","enhancePrompt"],g);let y=tt(e,["generateAudio"]);void 0!==t&&null!=y&&te(t,["parameters","generateAudio"],y);let E=tt(e,["lastFrame"]);void 0!==t&&null!=E&&te(t,["instances[0]","lastFrame"],nT(E));let _=tt(e,["referenceImages"]);if(void 0!==t&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l;return n={},null!=(i=tt(t=e,["image"]))&&te(n,["image"],nT(i)),null!=(l=tt(t,["referenceType"]))&&te(n,["referenceType"],l),n})),te(t,["instances[0]","referenceImages"],e)}let v=tt(e,["mask"]);void 0!==t&&null!=v&&te(t,["instances[0]","mask"],(i={},null!=(l=tt(n=v,["image"]))&&te(i,["_self"],nT(l)),null!=(r=tt(n,["maskMode"]))&&te(i,["maskMode"],r),i));let I=tt(e,["compressionQuality"]);void 0!==t&&null!=I&&te(t,["parameters","compressionQuality"],I)}(y,u),u);return d=e9("{model}:predictLongRunning",E._url),c=E._query,delete E._url,delete E._query,this.apiClient.request({path:d,queryParams:c,body:JSON.stringify(E),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i,l,r,o,a=(t={},null!=(n=tt(e,["name"]))&&te(t,["name"],n),null!=(i=tt(e,["metadata"]))&&te(t,["metadata"],i),null!=(l=tt(e,["done"]))&&te(t,["done"],l),null!=(r=tt(e,["error"]))&&te(t,["error"],r),null!=(o=tt(e,["response"]))&&te(t,["response"],function(e){let t={},n=tt(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a;return n={},null!=(i=tt(e,["_self"]))&&te(n,["video"],(l={},null!=(r=tt(t=i,["gcsUri"]))&&te(l,["uri"],r),null!=(o=tt(t,["bytesBase64Encoded"]))&&te(l,["videoBytes"],tn(o)),null!=(a=tt(t,["mimeType"]))&&te(l,["mimeType"],a),l)),n})),te(t,["generatedVideos"],e)}let i=tt(e,["raiMediaFilteredCount"]);null!=i&&te(t,["raiMediaFilteredCount"],i);let l=tt(e,["raiMediaFilteredReasons"]);return null!=l&&te(t,["raiMediaFilteredReasons"],l),t}(o)),t),s=new tg;return Object.assign(s,a),s})}{let t,n,r,a,s,h,m,f,g,y,E=(o=this.apiClient,a={},null!=(s=tt(e,["model"]))&&te(a,["_url","model"],tM(o,s)),null!=(h=tt(e,["prompt"]))&&te(a,["instances[0]","prompt"],h),null!=(m=tt(e,["image"]))&&te(a,["instances[0]","image"],nI(m)),null!=(f=tt(e,["video"]))&&te(a,["instances[0]","video"],nR(f)),null!=(g=tt(e,["source"]))&&(u=g,p=a,t=tt(u,["prompt"]),void 0!==p&&null!=t&&te(p,["instances[0]","prompt"],t),n=tt(u,["image"]),void 0!==p&&null!=n&&te(p,["instances[0]","image"],nI(n)),r=tt(u,["video"]),void 0!==p&&null!=r&&te(p,["instances[0]","video"],nR(r))),null!=(y=tt(e,["config"]))&&function(e,t){let n=tt(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&te(t,["parameters","sampleCount"],n),void 0!==tt(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==tt(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let i=tt(e,["durationSeconds"]);if(void 0!==t&&null!=i&&te(t,["parameters","durationSeconds"],i),void 0!==tt(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let l=tt(e,["aspectRatio"]);void 0!==t&&null!=l&&te(t,["parameters","aspectRatio"],l);let r=tt(e,["resolution"]);void 0!==t&&null!=r&&te(t,["parameters","resolution"],r);let o=tt(e,["personGeneration"]);if(void 0!==t&&null!=o&&te(t,["parameters","personGeneration"],o),void 0!==tt(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let a=tt(e,["negativePrompt"]);void 0!==t&&null!=a&&te(t,["parameters","negativePrompt"],a);let s=tt(e,["enhancePrompt"]);if(void 0!==t&&null!=s&&te(t,["parameters","enhancePrompt"],s),void 0!==tt(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let u=tt(e,["lastFrame"]);void 0!==t&&null!=u&&te(t,["instances[0]","lastFrame"],nI(u));let p=tt(e,["referenceImages"]);if(void 0!==t&&null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l;return n={},null!=(i=tt(t=e,["image"]))&&te(n,["image"],nI(i)),null!=(l=tt(t,["referenceType"]))&&te(n,["referenceType"],l),n})),te(t,["instances[0]","referenceImages"],e)}if(void 0!==tt(e,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==tt(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(y,a),a);return d=e9("{model}:predictLongRunning",E._url),c=E._query,delete E._url,delete E._query,this.apiClient.request({path:d,queryParams:c,body:JSON.stringify(E),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i,l,r,o,a=(t={},null!=(n=tt(e,["name"]))&&te(t,["name"],n),null!=(i=tt(e,["metadata"]))&&te(t,["metadata"],i),null!=(l=tt(e,["done"]))&&te(t,["done"],l),null!=(r=tt(e,["error"]))&&te(t,["error"],r),null!=(o=tt(e,["response","generateVideoResponse"]))&&te(t,["response"],function(e){let t={},n=tt(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a;return n={},null!=(i=tt(e,["video"]))&&te(n,["video"],(l={},null!=(r=tt(t=i,["uri"]))&&te(l,["uri"],r),null!=(o=tt(t,["encodedVideo"]))&&te(l,["videoBytes"],tn(o)),null!=(a=tt(t,["encoding"]))&&te(l,["mimeType"],a),l)),n})),te(t,["generatedVideos"],e)}let i=tt(e,["raiMediaFilteredCount"]);null!=i&&te(t,["raiMediaFilteredCount"],i);let l=tt(e,["raiMediaFilteredReasons"]);return null!=l&&te(t,["raiMediaFilteredReasons"],l),t}(o)),t),s=new tg;return Object.assign(s,a),s})}}}class nz extends e7{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,a=(i={},null!=(l=tt(e,["operationName"]))&&te(i,["_url","operationName"],l),i);return r=e9("{operationName}",a._url),o=a._query,delete a._url,delete a._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}{let t,n,a=(t={},null!=(n=tt(e,["operationName"]))&&te(t,["_url","operationName"],n),t);return r=e9("{operationName}",a._url),o=a._query,delete a._url,delete a._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json())}}async fetchPredictVideosOperationInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r,o,a,s=(r={},null!=(o=tt(e,["operationName"]))&&te(r,["operationName"],o),null!=(a=tt(e,["resourceName"]))&&te(r,["_url","resourceName"],a),r);return i=e9("{resourceName}:fetchPredictOperation",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}throw Error("This method is only supported by the Vertex AI.")}}class nX extends e7{constructor(e){super(),this.apiClient=e}async create(e){var t,n,i,l,r;let o="",a={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let s,u,p,d,c,h,m,f,g,y,E=(i=this.apiClient,d={},null!=(c=tt(e,["config"]))&&te(d,["config"],(h=tt(c,["expireTime"]),void 0!==d&&null!=h&&te(d,["expireTime"],h),m=tt(c,["newSessionExpireTime"]),void 0!==d&&null!=m&&te(d,["newSessionExpireTime"],m),f=tt(c,["uses"]),void 0!==d&&null!=f&&te(d,["uses"],f),g=tt(c,["liveConnectConstraints"]),void 0!==d&&null!=g&&te(d,["bidiGenerateContentSetup"],(l=i,s={},null!=(u=tt(r=g,["model"]))&&te(s,["setup","model"],tM(l,u)),null!=(p=tt(r,["config"]))&&te(s,["config"],function(e,t){let n=tt(e,["generationConfig"]);void 0!==t&&null!=n&&te(t,["setup","generationConfig"],n);let i=tt(e,["responseModalities"]);void 0!==t&&null!=i&&te(t,["setup","generationConfig","responseModalities"],i);let l=tt(e,["temperature"]);void 0!==t&&null!=l&&te(t,["setup","generationConfig","temperature"],l);let r=tt(e,["topP"]);void 0!==t&&null!=r&&te(t,["setup","generationConfig","topP"],r);let o=tt(e,["topK"]);void 0!==t&&null!=o&&te(t,["setup","generationConfig","topK"],o);let a=tt(e,["maxOutputTokens"]);void 0!==t&&null!=a&&te(t,["setup","generationConfig","maxOutputTokens"],a);let s=tt(e,["mediaResolution"]);void 0!==t&&null!=s&&te(t,["setup","generationConfig","mediaResolution"],s);let u=tt(e,["seed"]);void 0!==t&&null!=u&&te(t,["setup","generationConfig","seed"],u);let p=tt(e,["speechConfig"]);void 0!==t&&null!=p&&te(t,["setup","generationConfig","speechConfig"],tK(p));let d=tt(e,["thinkingConfig"]);void 0!==t&&null!=d&&te(t,["setup","generationConfig","thinkingConfig"],d);let c=tt(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&te(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=tt(e,["systemInstruction"]);void 0!==t&&null!=h&&te(t,["setup","systemInstruction"],function(e){let t={},n=tt(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,a,s,u,p,d,c,h;return n={},null!=(i=tt(t=e,["mediaResolution"]))&&te(n,["mediaResolution"],i),null!=(l=tt(t,["codeExecutionResult"]))&&te(n,["codeExecutionResult"],l),null!=(r=tt(t,["executableCode"]))&&te(n,["executableCode"],r),null!=(o=tt(t,["fileData"]))&&te(n,["fileData"],function(e){let t={};if(void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tt(e,["fileUri"]);null!=n&&te(t,["fileUri"],n);let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(o)),null!=(a=tt(t,["functionCall"]))&&te(n,["functionCall"],function(e){let t={},n=tt(e,["id"]);null!=n&&te(t,["id"],n);let i=tt(e,["args"]);null!=i&&te(t,["args"],i);let l=tt(e,["name"]);if(null!=l&&te(t,["name"],l),void 0!==tt(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tt(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(a)),null!=(s=tt(t,["functionResponse"]))&&te(n,["functionResponse"],s),null!=(u=tt(t,["inlineData"]))&&te(n,["inlineData"],function(e){let t={},n=tt(e,["data"]);if(null!=n&&te(t,["data"],n),void 0!==tt(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tt(e,["mimeType"]);return null!=i&&te(t,["mimeType"],i),t}(u)),null!=(p=tt(t,["text"]))&&te(n,["text"],p),null!=(d=tt(t,["thought"]))&&te(n,["thought"],d),null!=(c=tt(t,["thoughtSignature"]))&&te(n,["thoughtSignature"],c),null!=(h=tt(t,["videoMetadata"]))&&te(n,["videoMetadata"],h),n})),te(t,["parts"],e)}let i=tt(e,["role"]);return null!=i&&te(t,["role"],i),t}(tV(h)));let m=tt(e,["tools"]);if(void 0!==t&&null!=m){let e=t$(m);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tt(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["functionDeclarations"],e)}if(void 0!==tt(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tt(e,["googleSearchRetrieval"]);null!=i&&te(t,["googleSearchRetrieval"],i);let l=tt(e,["computerUse"]);null!=l&&te(t,["computerUse"],l);let r=tt(e,["fileSearch"]);null!=r&&te(t,["fileSearch"],r);let o=tt(e,["codeExecution"]);if(null!=o&&te(t,["codeExecution"],o),void 0!==tt(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let a=tt(e,["googleMaps"]);null!=a&&te(t,["googleMaps"],function(e){let t={};if(void 0!==tt(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tt(e,["enableWidget"]);return null!=n&&te(t,["enableWidget"],n),t}(a));let s=tt(e,["googleSearch"]);null!=s&&te(t,["googleSearch"],function(e){let t={};if(void 0!==tt(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tt(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tt(e,["timeRangeFilter"]);return null!=n&&te(t,["timeRangeFilter"],n),t}(s));let u=tt(e,["urlContext"]);return null!=u&&te(t,["urlContext"],u),t})(tW(e)))),te(t,["setup","tools"],e)}let f=tt(e,["sessionResumption"]);void 0!==t&&null!=f&&te(t,["setup","sessionResumption"],function(e){let t={},n=tt(e,["handle"]);if(null!=n&&te(t,["handle"],n),void 0!==tt(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(f));let g=tt(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&te(t,["setup","inputAudioTranscription"],g);let y=tt(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&te(t,["setup","outputAudioTranscription"],y);let E=tt(e,["realtimeInputConfig"]);void 0!==t&&null!=E&&te(t,["setup","realtimeInputConfig"],E);let _=tt(e,["contextWindowCompression"]);void 0!==t&&null!=_&&te(t,["setup","contextWindowCompression"],_);let v=tt(e,["proactivity"]);return void 0!==t&&null!=v&&te(t,["setup","proactivity"],v),{}}(p,s)),s)),y=tt(c,["lockAdditionalFields"]),void 0!==d&&null!=y&&te(d,["fieldMask"],y),{})),d);o=e9("auth_tokens",E._url),a=E._query,delete E.config,delete E._url,delete E._query;let _=function(e,t){let n=null,i=e.bidiGenerateContentSetup;if("object"==typeof i&&null!==i&&"setup"in i){let t=i.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==i&&delete e.bidiGenerateContentSetup;let l=e.fieldMask;if(n){let i=function(e){let t=[];for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let i=e[n];if("object"==typeof i&&null!=i&&Object.keys(i).length>0){let e=Object.keys(i).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)i?e.fieldMask=i:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==l&&Array.isArray(l)&&l.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],n=[];l.length>0&&(n=l.map(e=>t.includes(e)?`generationConfig.${e}`:e));let r=[];i&&r.push(i),n.length>0&&r.push(...n),r.length>0?e.fieldMask=r.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==l&&Array.isArray(l)&&l.length>0?e.fieldMask=l.join(","):delete e.fieldMask;return e}(E,e.config);return this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(_),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}}class nQ extends e7{constructor(e){super(),this.apiClient=e,this.list=async e=>new t9(e6.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a=(r={},null!=(o=tt(e,["name"]))&&te(r,["_url","name"],o),r);return i=e9("{name}",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s,u=(r={},null!=(o=tt(e,["name"]))&&te(r,["_url","name"],o),null!=(a=tt(e,["config"]))&&(s=tt(a,["force"]),void 0!==r&&null!=s&&te(r,["_query","force"],s)),r);i=e9("{name}",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s,u,p=(r={},null!=(o=tt(e,["parent"]))&&te(r,["_url","parent"],o),null!=(a=tt(e,["config"]))&&(s=tt(a,["pageSize"]),void 0!==r&&null!=s&&te(r,["_query","pageSize"],s),u=tt(a,["pageToken"]),void 0!==r&&null!=u&&te(r,["_query","pageToken"],u)),r);return i=e9("{parent}/documents",p._url),l=p._query,delete p._url,delete p._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["documents"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["documents"],e)}return t}(e),n=new tv;return Object.assign(n,t),n})}}}class nZ extends e7{constructor(e,t=new nQ(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new t9(e6.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s=(r={},null!=(o=tt(e,["config"]))&&(a=tt(o,["displayName"]),void 0!==r&&null!=a&&te(r,["displayName"],a)),r);return i=e9("fileSearchStores",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a=(r={},null!=(o=tt(e,["name"]))&&te(r,["_url","name"],o),r);return i=e9("{name}",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s,u=(r={},null!=(o=tt(e,["name"]))&&te(r,["_url","name"],o),null!=(a=tt(e,["config"]))&&(s=tt(a,["force"]),void 0!==r&&null!=s&&te(r,["_query","force"],s)),r);i=e9("{name}",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s,u=(r={},null!=(o=tt(e,["config"]))&&(a=tt(o,["pageSize"]),void 0!==r&&null!=a&&te(r,["_query","pageSize"],a),s=tt(o,["pageToken"]),void 0!==r&&null!=s&&te(r,["_query","pageToken"],s)),r);return i=e9("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tt(e,["sdkHttpResponse"]);null!=n&&te(t,["sdkHttpResponse"],n);let i=tt(e,["nextPageToken"]);null!=i&&te(t,["nextPageToken"],i);let l=tt(e,["fileSearchStores"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["fileSearchStores"],e)}return t}(e),n=new tI;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s=(r={},null!=(o=tt(e,["fileSearchStoreName"]))&&te(r,["_url","file_search_store_name"],o),null!=(a=tt(e,["config"]))&&function(e,t){let n=tt(e,["mimeType"]);void 0!==t&&null!=n&&te(t,["mimeType"],n);let i=tt(e,["displayName"]);void 0!==t&&null!=i&&te(t,["displayName"],i);let l=tt(e,["customMetadata"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["customMetadata"],e)}let r=tt(e,["chunkingConfig"]);void 0!==t&&null!=r&&te(t,["chunkingConfig"],r)}(a,r),r);return i=e9("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i=(t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),t),l=new tT;return Object.assign(l,i),l})}}async importFile(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s,u=(r={},null!=(o=tt(e,["fileSearchStoreName"]))&&te(r,["_url","file_search_store_name"],o),null!=(a=tt(e,["fileName"]))&&te(r,["fileName"],a),null!=(s=tt(e,["config"]))&&function(e,t){let n=tt(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te(t,["customMetadata"],e)}let i=tt(e,["chunkingConfig"]);void 0!==t&&null!=i&&te(t,["chunkingConfig"],i)}(s,r),r);return i=e9("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{var t;let n,i,l,r,o,a,s,u,p,d,c=(o={},null!=(a=tt(e,["name"]))&&te(o,["name"],a),null!=(s=tt(e,["metadata"]))&&te(o,["metadata"],s),null!=(u=tt(e,["done"]))&&te(o,["done"],u),null!=(p=tt(e,["error"]))&&te(o,["error"],p),null!=(d=tt(e,["response"]))&&te(o,["response"],(n={},null!=(i=tt(t=d,["sdkHttpResponse"]))&&te(n,["sdkHttpResponse"],i),null!=(l=tt(t,["parent"]))&&te(n,["parent"],l),null!=(r=tt(t,["documentName"]))&&te(n,["documentName"],r),n)),o),h=new tA;return Object.assign(h,c),h})}}}function n0(e,t){let n,i,l,r={},o=tt(e,["sdkHttpResponse"]);null!=o&&te(r,["sdkHttpResponse"],o);let a=tt(e,["name"]);null!=a&&te(r,["name"],a);let s=tt(e,["state"]);null!=s&&te(r,["state"],tX(s));let u=tt(e,["createTime"]);null!=u&&te(r,["createTime"],u);let p=tt(e,["tuningTask","startTime"]);null!=p&&te(r,["startTime"],p);let d=tt(e,["tuningTask","completeTime"]);null!=d&&te(r,["endTime"],d);let c=tt(e,["updateTime"]);null!=c&&te(r,["updateTime"],c);let h=tt(e,["description"]);null!=h&&te(r,["description"],h);let m=tt(e,["baseModel"]);null!=m&&te(r,["baseModel"],m);let f=tt(e,["_self"]);return null!=f&&te(r,["tunedModel"],(n={},null!=(i=tt(f,["name"]))&&te(n,["model"],i),null!=(l=tt(f,["name"]))&&te(n,["endpoint"],l),n)),r}function n1(e,t){let n={},i=tt(e,["sdkHttpResponse"]);null!=i&&te(n,["sdkHttpResponse"],i);let l=tt(e,["name"]);null!=l&&te(n,["name"],l);let r=tt(e,["state"]);null!=r&&te(n,["state"],tX(r));let o=tt(e,["createTime"]);null!=o&&te(n,["createTime"],o);let a=tt(e,["startTime"]);null!=a&&te(n,["startTime"],a);let s=tt(e,["endTime"]);null!=s&&te(n,["endTime"],s);let u=tt(e,["updateTime"]);null!=u&&te(n,["updateTime"],u);let p=tt(e,["error"]);null!=p&&te(n,["error"],p);let d=tt(e,["description"]);null!=d&&te(n,["description"],d);let c=tt(e,["baseModel"]);null!=c&&te(n,["baseModel"],c);let h=tt(e,["tunedModel"]);null!=h&&te(n,["tunedModel"],h);let m=tt(e,["preTunedModel"]);null!=m&&te(n,["preTunedModel"],m);let f=tt(e,["supervisedTuningSpec"]);null!=f&&te(n,["supervisedTuningSpec"],f);let g=tt(e,["preferenceOptimizationSpec"]);null!=g&&te(n,["preferenceOptimizationSpec"],g);let y=tt(e,["tuningDataStats"]);null!=y&&te(n,["tuningDataStats"],y);let E=tt(e,["encryptionSpec"]);null!=E&&te(n,["encryptionSpec"],E);let _=tt(e,["partnerModelTuningSpec"]);null!=_&&te(n,["partnerModelTuningSpec"],_);let v=tt(e,["customBaseModel"]);null!=v&&te(n,["customBaseModel"],v);let I=tt(e,["experiment"]);null!=I&&te(n,["experiment"],I);let T=tt(e,["labels"]);null!=T&&te(n,["labels"],T);let A=tt(e,["outputUri"]);null!=A&&te(n,["outputUri"],A);let S=tt(e,["pipelineJob"]);null!=S&&te(n,["pipelineJob"],S);let C=tt(e,["serviceAccount"]);null!=C&&te(n,["serviceAccount"],C);let O=tt(e,["tunedModelDisplayName"]);null!=O&&te(n,["tunedModelDisplayName"],O);let b=tt(e,["veoTuningSpec"]);return null!=b&&te(n,["veoTuningSpec"],b),n}function n2(e,t){let n={},i=tt(e,["gcsUri"]);null!=i&&te(n,["validationDatasetUri"],i);let l=tt(e,["vertexDatasetResource"]);return null!=l&&te(n,["validationDatasetUri"],l),n}class n3 extends e7{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new t9(e6.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI())if(e.baseModel.startsWith("projects/")){let n={tunedModelName:e.baseModel};(null==(t=e.config)?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);let i=Object.assign(Object.assign({},e),{preTunedModel:n});return i.baseModel=void 0,await this.tuneInternal(i)}else{let t=Object.assign({},e);return await this.tuneInternal(t)}{let t=Object.assign({},e),n=await this.tuneMldevInternal(t),i="";return void 0!==n.metadata&&void 0!==n.metadata.tunedModel?i=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:eN.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,a=(i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],l),i);return r=e9("{name}",a._url),o=a._query,delete a._url,delete a._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>n1(e))}{let t,n,a=(t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],n),t);return r=e9("{name}",a._url),o=a._query,delete a._url,delete a._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>n0(e))}}async listInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,a,s,u,p=(i={},null!=(l=tt(e,["config"]))&&(a=tt(l,["pageSize"]),void 0!==i&&null!=a&&te(i,["_query","pageSize"],a),s=tt(l,["pageToken"]),void 0!==i&&null!=s&&te(i,["_query","pageToken"],s),u=tt(l,["filter"]),void 0!==i&&null!=u&&te(i,["_query","filter"],u)),i);return r=e9("tuningJobs",p._url),o=p._query,delete p._url,delete p._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=tt(e,["sdkHttpResponse"]);null!=i&&te(n,["sdkHttpResponse"],i);let l=tt(e,["nextPageToken"]);null!=l&&te(n,["nextPageToken"],l);let r=tt(e,["tuningJobs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>n1(e))),te(n,["tuningJobs"],e)}return n}(e),n=new ty;return Object.assign(n,t),n})}{let t,n,a,s,u,p=(t={},null!=(n=tt(e,["config"]))&&(a=tt(n,["pageSize"]),void 0!==t&&null!=a&&te(t,["_query","pageSize"],a),s=tt(n,["pageToken"]),void 0!==t&&null!=s&&te(t,["_query","pageToken"],s),u=tt(n,["filter"]),void 0!==t&&null!=u&&te(t,["_query","filter"],u)),t);return r=e9("tunedModels",p._url),o=p._query,delete p._url,delete p._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=tt(e,["sdkHttpResponse"]);null!=i&&te(n,["sdkHttpResponse"],i);let l=tt(e,["nextPageToken"]);null!=l&&te(n,["nextPageToken"],l);let r=tt(e,["tunedModels"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>n0(e))),te(n,["tuningJobs"],e)}return n}(e),n=new ty;return Object.assign(n,t),n})}}async cancel(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,a=(i={},null!=(l=tt(e,["name"]))&&te(i,["_url","name"],l),i);r=e9("{name}:cancel",a._url),o=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}else{let t,n,a=(t={},null!=(n=tt(e,["name"]))&&te(t,["_url","name"],n),t);r=e9("{name}:cancel",a._url),o=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal})}}async tuneInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r,o,a,s,u,p=(r={},null!=(o=tt(e,["baseModel"]))&&te(r,["baseModel"],o),null!=(a=tt(e,["preTunedModel"]))&&te(r,["preTunedModel"],a),null!=(s=tt(e,["trainingDataset"]))&&function(e,t,n){let i=tt(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=tt(e,["gcsUri"]);void 0!==t&&null!=n&&te(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===i){let n=tt(e,["gcsUri"]);void 0!==t&&null!=n&&te(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let l=tt(n,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){let n=tt(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&te(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===l){let n=tt(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&te(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==tt(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(s,r,e),null!=(u=tt(e,["config"]))&&function(e,t,n){let i=tt(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=tt(e,["validationDataset"]);void 0!==t&&null!=n&&te(t,["supervisedTuningSpec"],n2(n))}else if("PREFERENCE_TUNING"===i){let n=tt(e,["validationDataset"]);void 0!==t&&null!=n&&te(t,["preferenceOptimizationSpec"],n2(n))}let l=tt(e,["tunedModelDisplayName"]);void 0!==t&&null!=l&&te(t,["tunedModelDisplayName"],l);let r=tt(e,["description"]);void 0!==t&&null!=r&&te(t,["description"],r);let o=tt(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){let n=tt(e,["epochCount"]);void 0!==t&&null!=n&&te(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===o){let n=tt(e,["epochCount"]);void 0!==t&&null!=n&&te(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let a=tt(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){let n=tt(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&te(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===a){let n=tt(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&te(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let s=tt(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){let n=tt(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&te(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===s){let n=tt(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&te(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let u=tt(n,["config","method"]);if(void 0===u&&(u="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===u){let n=tt(e,["adapterSize"]);void 0!==t&&null!=n&&te(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===u){let n=tt(e,["adapterSize"]);void 0!==t&&null!=n&&te(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==tt(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==tt(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let p=tt(e,["labels"]);void 0!==t&&null!=p&&te(t,["labels"],p);let d=tt(e,["beta"]);void 0!==t&&null!=d&&te(t,["preferenceOptimizationSpec","hyperParameters","beta"],d)}(u,r,e),r);return i=e9("tuningJobs",p._url),l=p._query,delete p._url,delete p._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>n1(e))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,a,s,u,p=(r={},null!=(o=tt(e,["baseModel"]))&&te(r,["baseModel"],o),null!=(a=tt(e,["preTunedModel"]))&&te(r,["preTunedModel"],a),null!=(s=tt(e,["trainingDataset"]))&&function(e,t){if(void 0!==tt(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==tt(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let n=tt(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),te({},["examples","examples"],e)}}(s),null!=(u=tt(e,["config"]))&&function(e,t,n){if(void 0!==tt(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let i=tt(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=i&&te(t,["displayName"],i),void 0!==tt(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let l=tt(e,["epochCount"]);void 0!==t&&null!=l&&te(t,["tuningTask","hyperparameters","epochCount"],l);let r=tt(e,["learningRateMultiplier"]);if(null!=r&&te({},["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==tt(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==tt(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==tt(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let o=tt(e,["batchSize"]);void 0!==t&&null!=o&&te(t,["tuningTask","hyperparameters","batchSize"],o);let a=tt(e,["learningRate"]);if(void 0!==t&&null!=a&&te(t,["tuningTask","hyperparameters","learningRate"],a),void 0!==tt(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");if(void 0!==tt(e,["beta"]))throw Error("beta parameter is not supported in Gemini API.")}(u,r),r);return i=e9("tunedModels",p._url),l=p._query,delete p._url,delete p._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r,o;return t={},null!=(n=tt(e,["sdkHttpResponse"]))&&te(t,["sdkHttpResponse"],n),null!=(i=tt(e,["name"]))&&te(t,["name"],i),null!=(l=tt(e,["metadata"]))&&te(t,["metadata"],l),null!=(r=tt(e,["done"]))&&te(t,["done"],r),null!=(o=tt(e,["error"]))&&te(t,["error"],o),t})}}}class n4{async download(e,t){throw Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}let n5="x-goog-upload-status";async function n6(e,t,n){var i;let l=await n7(e,t,n),r=await (null==l?void 0:l.json());if((null==(i=null==l?void 0:l.headers)?void 0:i[n5])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return r.file}async function n8(e,t,n){var i;let l=await n7(e,t,n),r=await (null==l?void 0:l.json());if((null==(i=null==l?void 0:l.headers)?void 0:i[n5])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let o=ti(r),a=new tP;return Object.assign(a,o),a}async function n7(e,t,n){var i,l;let r=0,o=0,a=new tl(new Response),s="upload";for(r=e.size;o<r;){let u=Math.min(8388608,r-o),p=e.slice(o,o+u);o+u>=r&&(s+=", finalize");let d=0,c=1e3;for(;d<3&&(null==(i=null==(a=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":s,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}))?void 0:a.headers)||!i[n5]);)d++,await function(e){return new Promise(t=>setTimeout(t,e))}(c),c*=2;if(o+=u,(null==(l=null==a?void 0:a.headers)?void 0:l[n5])!=="active")break;if(r<=o)throw Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function n9(e){return{size:e.size,type:e.type}}class ie{async upload(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await n6(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await n8(e,t,n)}async stat(e){if("string"!=typeof e)return await n9(e);throw Error("File path is not supported in browser uploader.")}}class it{create(e,t,n){return new ii(e,t,n)}}class ii{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}let il="x-goog-api-key";class ir{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(il)){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw Error("API key is missing. Please provide a valid API key.");e.append(il,this.apiKey)}}}class io{constructor(e){var i;if(null==e.apiKey)throw Error("An API Key must be set when running in a browser");if(e.project||e.location)throw Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!=(i=e.vertexai)&&i,this.apiKey=e.apiKey;const l=function(e,i,l,r){return(null==e?void 0:e.baseUrl)?e.baseUrl:i?null!=n?n:l:null!=t?t:r}(e.httpOptions,e.vertexai,void 0,void 0);l&&(e.httpOptions?e.httpOptions.baseUrl=l:e.httpOptions={baseUrl:l}),this.apiVersion=e.apiVersion;const r=new ir(this.apiKey);this.apiClient=new nD({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new ie,downloader:new n4}),this.models=new n$(this.apiClient),this.live=new nV(this.apiClient,r,new it),this.batches=new ne(this.apiClient),this.chats=new ns(this.models,this.apiClient),this.caches=new nn(this.apiClient),this.files=new nd(this.apiClient),this.operations=new nz(this.apiClient),this.authTokens=new nX(this.apiClient),this.tunings=new n3(this.apiClient),this.fileSearchStores=new nZ(this.apiClient)}}let ia=null,is=()=>(ia||(ia=(()=>{let e=e8.default.env.API_KEY||e8.default.env.NEXT_PUBLIC_API_KEY;if(!e)throw Error("API_KEY environment variable not set");return new io({apiKey:e})})()),ia),iu=async e=>{let t=`
    Generate a personalized Systematic Investment Plan (SIP) for a user with the following profile:
    - Monthly Income: ${e.monthlyIncome}
    - Age: ${e.age} years
    - Number of Dependents: ${e.familyMembers}
    - Total Outstanding Loan Amount: ${e.existingLoans}
    - Years until loan is paid off: ${e.loanTenureRemaining}
    - Investment Time Horizon: ${e.investmentTimeHorizon} years
    - Risk Tolerance: ${e.riskTolerance}
    - Investment Goal: "${e.investmentGoal}"
    - Annual Step-Up: ${e.stepUpPercentage?e.stepUpPercentage+"%":"None"}

    Step 1: SEARCH. Use Google Search to find the latest top-performing mutual funds in India (Direct Plans, Growth option). 
    Prioritize data from trusted sources like Moneycontrol, Value Research, and Groww. 
    Look for funds with consistent 3Y and 5Y returns that match the user's risk profile and recommended asset allocation.

    Step 2: GENERATE PLAN. Create a comprehensive investment plan.

    Requirements:
    1.  Calculate a recommended monthly SIP amount.
    2.  Provide a detailed investment rationale. If a step-up percentage is provided, incorporate annual increases in the SIP amount into your growth projections and rationale.
    3.  Create a detailed asset allocation summing to 100%. You MUST break down the allocation into specific categories like 'Large Cap Equity', 'Mid Cap Equity', 'Small Cap Equity', 'International Equity', 'Debt/Bonds', 'Gold', 'Silver', etc., based on the user's risk profile. Do NOT use broad generic terms like 'Equity' or 'Mutual Funds'.
    4.  Provide investment growth projections for years 0, 1, 3, 5, and the final year (Conservative, Expected, Aggressive, Recovery, Crash scenarios). Factor in the annual step-up if applicable.
    5.  Recommend at least 2 specific mutual funds for each category based on your search results. Include 3Y/5Y returns, expense ratio, and a brief thesis.

    OUTPUT FORMAT:
    You must return ONLY a single valid JSON object. Do not include markdown code blocks (like \`\`\`json). 
    The JSON must strictly follow this structure:
    {
      "monthlySip": number,
      "riskProfile": string,
      "timeHorizon": number,
      "assetClasses": number,
      "investmentRationale": string,
      "assetAllocation": [ { "name": string, "value": number } ],
      "growthProjections": [ 
         { "year": number, "amountInvested": number, "conservative": number, "expected": number, "aggressive": number, "recovery": number, "crash": number } 
      ],
      "fundRecommendations": [
        {
          "category": string,
          "allocationPercentage": number,
          "funds": [
            {
              "name": string,
              "fundHouse": string,
              "threeYearReturns": string,
              "fiveYearReturns": string,
              "expenseRatio": string,
              "description": string
            }
          ]
        }
      ]
    }
    `,n="gemini-2.5-flash";try{var i;let e,l,r;console.log(`Attempting to generate plan with model: ${n} and Google Search`);let o=await is().models.generateContent({model:n,contents:t,config:{tools:[{googleSearch:{}}]}}),a=o.text;if(!a)throw Error("No text returned from AI");let s=a.match(/\{[\s\S]*\}/);s&&(a=s[0]);try{e=JSON.parse(a)}catch(e){throw console.error("Failed to parse JSON from text:",a),Error("The AI response was not in valid JSON format.")}let u=(i=e,(r=(l={monthlySip:Number(i.monthlySip)||0,riskProfile:String(i.riskProfile||"Not specified"),timeHorizon:Number(i.timeHorizon)||0,assetClasses:Number(i.assetClasses)||0,investmentRationale:String(i.investmentRationale||"No rationale provided."),assetAllocation:(Array.isArray(i.assetAllocation)?i.assetAllocation:[]).map(e=>({name:String(e.name||"Unnamed Asset"),value:Number(e.value)||0})),growthProjections:(Array.isArray(i.growthProjections)?i.growthProjections:[]).map(e=>({year:Number(e.year)||0,amountInvested:Number(e.amountInvested)||0,conservative:Number(e.conservative)||0,expected:Number(e.expected)||0,aggressive:Number(e.aggressive)||0,recovery:Number(e.recovery)||0,crash:Number(e.crash)||0})),fundRecommendations:(Array.isArray(i.fundRecommendations)?i.fundRecommendations:[]).map(e=>({category:String(e.category||"Uncategorized"),allocationPercentage:Number(e.allocationPercentage)||0,funds:(Array.isArray(e.funds)?e.funds:[]).map(e=>({name:String(e.name||"Unnamed Fund"),fundHouse:String(e.fundHouse||"Unknown"),threeYearReturns:String(e.threeYearReturns||"N/A"),fiveYearReturns:String(e.fiveYearReturns||"N/A"),expenseRatio:String(e.expenseRatio||"N/A"),description:String(e.description||"No description provided.")}))}))}).assetAllocation.reduce((e,t)=>e+t.value,0))>0&&Math.abs(r-100)>1&&(l.assetAllocation=l.assetAllocation.map(e=>({...e,value:Number((e.value/r*100).toFixed(2))}))),l);return o.candidates?.[0]?.groundingMetadata?.groundingChunks&&(u.groundingChunks=o.candidates[0].groundingMetadata.groundingChunks),u}catch(e){throw console.error(`Model (${n}) failed. Error:`,e instanceof Error?e.message:String(e)),Error("We're sorry, but we were unable to generate your investment plan at this time. Please try again later.")}},ip=null,id=()=>{ip=is().chats.create({model:"gemini-2.5-flash",config:{systemInstruction:`You are SIP Buddy, a specialized AI assistant for the SIP Buddy investment planning platform. Your sole purpose is to help users with questions about Systematic Investment Plans (SIPs), mutual funds, investment strategies, and using the SIP Buddy application.
- Your name is SIP Buddy.
- You MUST NOT answer questions about your origin, who created you, your underlying technology, or any topic outside of financial planning and the SIP Buddy platform.
- If a user asks an off-topic question (e.g., "Who made you?", "Are you from Google?", "Tell me a joke"), you MUST politely decline and steer the conversation back to financial planning. For example: "As SIP Buddy, my expertise is in financial planning. How can I help you with your investment questions?"
- Keep your answers concise, helpful, and strictly within your designated role.`}})},ic=async e=>(ip||id(),ip)?(await ip.sendMessage({message:e})).text||"No response text":"Chat not initialized. Please try again.",ih=async e=>{let t="latitude"in e?`near latitude ${e.latitude} and longitude ${e.longitude}`:`near "${e.query}"`,n=`
        Find registered financial advisors ${t}.
        Return a list of up to 10 advisors.
        For each advisor, you MUST provide their Name, Firm, full Address, Phone number, and Website.
        You MUST also provide their precise geographic coordinates (Latitude and Longitude) IF they are available from the mapping service.
        The entire response must be a single, valid JSON array of objects.
        Each object in the array should have the following keys: "name", "firm", "address", "phone", "website", "latitude", "longitude".
        The values for latitude and longitude must be numbers if available; otherwise, they MUST be null. All other values must be strings.
        If a piece of information is not available for a non-essential field like phone or website, use an empty string "" as the value. The name and address fields are mandatory.
        Do not include any introductory text, explanations, markdown formatting (like \`\`\`json), or any text outside of the single JSON array itself.
    `,i="latitude"in e?{retrievalConfig:{latLng:{latitude:e.latitude,longitude:e.longitude}}}:void 0,l=await is().models.generateContent({model:"gemini-2.5-flash",contents:n,config:{tools:[{googleMaps:{}}],toolConfig:i}}),r=l.text,o=l.candidates?.[0]?.groundingMetadata?.groundingChunks||[],a=[];try{if(!r)throw Error("No text returned from AI");let e=r.match(/\[[\s\S]*\]/);if(e&&e[0]){let t=JSON.parse(e[0]);Array.isArray(t)?a=t.map(e=>({name:String(e.name||"Unnamed Advisor"),firm:String(e.firm||""),address:String(e.address||"No address provided"),phone:String(e.phone||""),website:String(e.website||""),latitude:"number"==typeof e.latitude?e.latitude:null,longitude:"number"==typeof e.longitude?e.longitude:null})).filter(e=>"Unnamed Advisor"!==e.name&&"No address provided"!==e.address):console.warn("Parsed data is not an array:",t)}else console.warn("No valid JSON array found in the response.",r)}catch(e){console.error("Failed to parse JSON response for financial advisors:",e),console.error("Raw text from API:",r)}return{advisors:a,groundingChunks:o}},im=async e=>{try{let t=await is().models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:`Say this in a friendly and helpful tone: ${e}`}]}],config:{responseModalities:[eS.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}}}}),n=t.candidates?.[0]?.content?.parts?.[0]?.inlineData?.data;if(n)return n;throw Error("No audio data received from TTS API.")}catch(e){throw console.error("Error in textToSpeech:",e),Error("Failed to generate speech.")}},ig=async e=>{try{let t=await new Promise((t,n)=>{let i=new FileReader;i.onloadend=()=>{t(i.result.split(",")[1])},i.onerror=n,i.readAsDataURL(e)}),n={inlineData:{mimeType:e.type,data:t}};return(await is().models.generateContent({model:"gemini-2.5-flash",contents:{parts:[n,{text:"Transcribe the following audio accurately:"}]}})).text||""}catch(e){throw console.error("Error in transcribeAudio:",e),Error("Failed to transcribe audio.")}},iy=async e=>{let t=`
        Generate a financial literacy quiz with exactly 10 unique questions.
        Difficulty Level: ${e}.
        Topics: Personal Finance, Investing (SIP, Mutual Funds, Stocks), Taxes (India context), and General Financial Literacy.

        Output Requirements:
        1. Return ONLY a JSON array of objects. Do not include markdown formatting (like \`\`\`json).
        2. Ensure diverse question types in the following distribution:
           - 4 Single Choice (type: 'single_choice')
           - 2 Multiple Choice (type: 'multiple_choice') - require 2 or more correct options
           - 2 True/False (type: 'true_false')
           - 1 Fill in the Blank (type: 'fill_in_blank')
           - 1 Short Answer (type: 'short_answer')
        3. Structure each object exactly like this:
           {
             "id": number, // 1 to 10
             "type": string, // one of the types listed above
             "question": string,
             "options": string[], // Array of options for MCQs. For 'true_false', MUST be ["True", "False"]. Null or empty array for text inputs.
             "correctAnswer": string | string[], // String for single/text, Array of strings for multiple_choice
             "acceptedKeywords": string[], // Array of acceptable keywords/synonyms for text answers (case-insensitive matching)
             "explanation": string // Brief explanation of the correct answer
           }
        
        For 'multiple_choice', 'correctAnswer' MUST be an array of strings matching the correct options.
        For 'fill_in_blank' and 'short_answer', 'options' should be empty, and 'correctAnswer' should be the main answer string. 'acceptedKeywords' is crucial here for validation (e.g. if answer is "Equity", keywords could be ["Equity", "Equities", "Stock", "Stocks"]).
    `;try{let e=(await is().models.generateContent({model:"gemini-2.5-flash",contents:t})).text;if(!e)throw Error("No text returned from AI");let n=e.match(/\[[\s\S]*\]/);n&&(e=n[0]);let i=JSON.parse(e);if(!Array.isArray(i)||0===i.length)throw Error("Invalid format returned from AI");return i}catch(e){throw console.error("Quiz generation failed:",e),Error("Failed to generate quiz questions. Please try again.")}};e.s(["findFinancialAdvisors",0,ih,"generateInvestmentPlan",0,iu,"generateQuizQuestions",0,iy,"sendMessageToChat",0,ic,"startChat",0,id,"textToSpeech",0,im,"transcribeAudio",0,ig],53374)}]);